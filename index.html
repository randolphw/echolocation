<html>
<head>
<title>echolocation</title>
<style type="text/css">
@font-face {font-family: Aurebesh; src: url(fonts/aurebesh.ttf);}
body {font-family: Arial; font-size: small; color: white;}
table {position: relative; z-index: 100;}
canvas {position: absolute; top: 10px; left: 65px; border: 1px solid #424242;}
td {position: relative;}
td.button {background-color: black; border: 1px solid #424242; text-align: center;}
td.move {width: 20px; height: 22px; font-family: Aurebesh; font-size: 12px;}
td.actions {width: 44px; height: 30px;}
td.select {vertical-align: bottom; height: 119px;}
img.mirror {transform: scale(-1, 1); -webkit-transform: scale(-1, 1);}
img.rotateL {transform: rotate(-90deg); -webkit-transform: rotate(-90deg);}
img.rotateR {transform: rotate(90deg); -webkit-transform: rotate(90deg);}
img.mirrorL {transform: scale(-1, 1) rotate(90deg); -webkit-transform: scale(-1, 1) rotate(90deg);}
img.mirrorR {transform: scale(-1, 1) rotate(-90deg); -webkit-transform: scale(-1, 1) rotate(-90deg);}
img.overlay {position: absolute; top: 0px; left: 0px;}
img.decloak {width: 20px; height: 20px;}
img.maneuver {width: 20px; height: 20px;}
a {position: relative;}
a.lock {position: absolute; top: 0px; left: 0px; font-size: 10px;}

.option {width: 50px; height: 50px; text-align: center; font-family: Aurebesh; font-size: 13px;}
</style>
<script type="text/javascript">
<!--

var pi = Math.PI;

var rBank = [0, 80, 130, 180];
var rTurn = [0, 35, 63, 90];

var smallbase = 40;
var largebase = 80;

var tiephantom = {
	faction: "empire",
	id: "tiephantom",
	base: smallbase,
	protrusions: 17,
	width: 40,
	height: 58,
	pilots: ["echo"],
	actions: ["roll"],
	slots: ["crew", "system"],
	decloak: [
		["straight", "blue", 2],
		["roll", "blue", 2, -1, 1],
		["roll", "blue", 2, 1, 1],
		["roll", "blue", 2, -1, -1],
		["roll", "blue", 2, 1, -1]
	],
	dial: [
		["turn", "white", 1, -1],
		["turn", "white", 1, 1],
		["turn", "white", 2, -1],
		["bank", "green", 2, -1],
		["straight", "green", 2],
		["bank", "green", 2, 1],
		["turn", "white", 2, 1],
		["turn", "white", 3, -1],
		["bank", "white", 3, -1],
		["straight", "green", 3],
		["bank", "white", 3, 1],
		["turn", "white", 3, 1],
		["koiogran", "red", 3],
		["straight", "white", 4],
		["koiogran", "red", 4]
	]
};
tiephantom.img = new Image();
tiephantom.img.src = "images/tiephantom.png";
tiephantom.img.onload = function() {initialize();};

var echo = {
	id: "echo",
	img: tiephantom.img,
	vessel: tiephantom,
	slots: ["elite", "crew", "system"],
	decloak: [
		["bank", "blue", 2, -1],
		["bank", "blue", 2, 1],
		["bankroll", "blue", 2, -1, 1, 1],
		["bankroll", "blue", 2, -1, -1, 1],
		["bankroll", "blue", 2, 1, 1, -1],
		["bankroll", "blue", 2, 1, -1, -1],
		["bankroll", "blue", 2, -1, 1, -1],
		["bankroll", "blue", 2, -1, -1, -1],
		["bankroll", "blue", 2, 1, 1, 1],
		["bankroll", "blue", 2, 1, -1, 1]
	]
};

var tieadvanced = {
	faction: "empire",
	id: "tieadvanced",
	base: smallbase,
	protrusions: 1,
	width: 40,
	height: 49,
	pilots: ["junoeclipse"],
	actions: ["roll"],
	slots: ["system"],
	decloak: [],
	dial: [
		["bank", "green", 1, -1],
		["bank", "green", 1, 1],
		["turn", "white", 2, -1],
		["bank", "white", 2, -1],
		["straight", "green", 2],
		["bank", "white", 2, 1],
		["turn", "white", 2, 1],
		["turn", "white", 3, -1],
		["bank", "white", 3, -1],
		["straight", "green", 3],
		["bank", "white", 3, 1],
		["turn", "white", 3, 1],
		["straight", "white", 4],
		["koiogran", "red", 4],
		["straight", "white", 5]
	]
};
tieadvanced.img = new Image();
tieadvanced.img.src = "images/tieadvanced.png";

var junoeclipse = {
	id: "junoeclipse",
	img: tieadvanced.img,
	vessel: tieadvanced,
	slots: ["elite", "system"],
	dial: [
		["turn", "white", 1, -1],
		["bank", "green", 1, -1],
		["straight", "green", 1],
		["bank", "green", 1, 1],
		["turn", "white", 1, 1],
		["turn", "white", 2, -1],
		["bank", "white", 2, -1],
		["straight", "green", 2],
		["bank", "white", 2, 1],
		["turn", "white", 2, 1],
		["turn", "white", 3, -1],
		["bank", "white", 3, -1],
		["straight", "green", 3],
		["bank", "white", 3, 1],
		["turn", "white", 3, 1],
		["koiogran", "red", 3],
		["straight", "white", 4],
		["koiogran", "red", 4],
		["straight", "white", 5],
		["koiogran", "red", 5]
	]
};

var tieadvprototype = {
	faction: "empire",
	id: "tieadvprototype",
	base: smallbase,
	protrusions: 1,
	width: 40,
	height: 42,
	actions: ["roll", "boost"],
	slots: [],
	decloak: [],
	dial: [
		["turn", "green", 1, -1],
		["bank", "green", 1, -1],
		["bank", "green", 1, 1],
		["turn", "green", 1, 1],
		["turn", "white", 2, -1],
		["bank", "white", 2, -1],
		["straight", "green", 2],
		["bank", "white", 2, 1],
		["turn", "white", 2, 1],
		["turn", "white", 3, -1],
		["bank", "white", 3, -1],
		["straight", "green", 3],
		["bank", "white", 3, 1],
		["turn", "white", 3, 1],
		["straight", "green", 4],
		["koiogran", "red", 4],
		["straight", "white", 5]
	]
};
tieadvprototype.img = new Image();
tieadvprototype.img.src = "images/tieadvprototype.png";

var tiebomber = {
	faction: "empire",
	id: "tiebomber",
	base: smallbase,
	protrusions: 1,
	offset: 4,
	width: 47,
	height: 48,
	actions: ["roll"],
	slots: [],
	decloak: [],
	dial: [
		["bank", "white", 1, -1],
		["straight", "green", 1],
		["bank", "white", 1, 1],
		["turn", "red", 2, -1],
		["bank", "white", 2, -1],
		["straight", "green", 2],
		["bank", "white", 2, 1],
		["turn", "red", 2, 1],
		["turn", "white", 3, -1],
		["bank", "white", 3, -1],
		["straight", "green", 3],
		["bank", "white", 3, 1],
		["turn", "white", 3, 1],
		["straight", "white", 4],
		["koiogran", "red", 5]
	]
};
tiebomber.img = new Image();
tiebomber.img.src = "images/tiebomber.png";

var tiedefender = {
	faction: "empire",
	id: "tiedefender",
	base: smallbase,
	protrusions: 5,
	offset: 8,
	width: 56,
	height: 47,
	pilots: ["countessryad"],
	actions: ["roll"],
	slots: [],
	decloak: [],
	dial: [
		["turn", "red", 1, -1],
		["bank", "white", 1, -1],
		["bank", "white", 1, 1],
		["turn", "red", 1, 1],
		["turn", "red", 2, -1],
		["bank", "white", 2, -1],
		["straight", "green", 2],
		["bank", "white", 2, 1],
		["turn", "red", 2, 1],
		["turn", "white", 3, -1],
		["bank", "white", 3, -1],
		["straight", "green", 3],
		["bank", "white", 3, 1],
		["turn", "white", 3, 1],
		["straight", "green", 4],
		["koiogran", "white", 4],
		["straight", "green", 5]
	]
};
tiedefender.img = new Image();
tiedefender.img.src = "images/tiedefender.png";

var countessryad = {
	id: "countessryad",
	img: tiedefender.img,
	vessel: tiedefender,
	slots: ["elite"],
	dial: [
		["turn", "red", 1, -1],
		["bank", "white", 1, -1],
		["bank", "white", 1, 1],
		["turn", "red", 1, 1],
		["turn", "red", 2, -1],
		["bank", "white", 2, -1],
		["straight", "green", 2],
		["bank", "white", 2, 1],
		["turn", "red", 2, 1],
		["koiogran", "green", 2],
		["turn", "white", 3, -1],
		["bank", "white", 3, -1],
		["straight", "green", 3],
		["bank", "white", 3, 1],
		["turn", "white", 3, 1],
		["koiogran", "green", 3],
		["straight", "green", 4],
		["koiogran", "green", 4],
		["straight", "green", 5],
		["koiogran", "green", 5]
	]
};

var tiefighter = {
	faction: "empire",
	id: "tiefighter",
	base: smallbase,
	protrusions: 1,
	offset: 1,
	width: 42,
	height: 42,
	actions: ["roll"],
	slots: [],
	decloak: [],
	dial: [
		["turn", "white", 1, -1],
		["turn", "white", 1, 1],
		["turn", "white", 2, -1],
		["bank", "green", 2, -1],
		["straight", "green", 2],
		["bank", "green", 2, 1],
		["turn", "white", 2, 1],
		["turn", "white", 3, -1],
		["bank", "white", 3, -1],
		["straight", "green", 3],
		["bank", "white", 3, 1],
		["turn", "white", 3, 1],
		["koiogran", "red", 3],
		["straight", "white", 4],
		["koiogran", "red", 4],
		["straight", "white", 5]
	]
};
tiefighter.img = new Image();
tiefighter.img.src = "images/tiefighter.png";

var tieinterceptor = {
	faction: "empire",
	id: "tieinterceptor",
	base: smallbase,
	protrusions: 14,
	width: 40,
	height: 55,
	actions: ["roll", "boost"],
	slots: [],
	decloak: [],
	dial: [
		["turn", "white", 1, -1],
		["turn", "white", 1, 1],
		["turn", "green", 2, -1],
		["bank", "green", 2, -1],
		["straight", "green", 2],
		["bank", "green", 2, 1],
		["turn", "green", 2, 1],
		["turn", "white", 3, -1],
		["bank", "white", 3, -1],
		["straight", "green", 3],
		["bank", "white", 3, 1],
		["turn", "white", 3, 1],
		["koiogran", "red", 3],
		["straight", "green", 4],
		["straight", "white", 5],
		["koiogran", "red", 5]
	]
};
tieinterceptor.img = new Image();
tieinterceptor.img.src = "images/tieinterceptor.png";

var tiepunisher = {
	faction: "empire",
	id: "tiepunisher",
	base: smallbase,
	protrusions: 3,
	offset: 9,
	width: 57,
	height: 52,
	actions: ["boost"],
	slots: ["system"],
	decloak: [],
	dial: [
		["bank", "green", 1, -1],
		["straight", "green", 1],
		["bank", "green", 1, 1],
		["turn", "red", 2, -1],
		["bank", "white", 2, -1],
		["straight", "green", 2],
		["bank", "white", 2, 1],
		["turn", "red", 2, 1],
		["turn", "white", 3, -1],
		["bank", "white", 3, -1],
		["straight", "white", 3],
		["bank", "white", 3, 1],
		["turn", "white", 3, 1],
		["koiogran", "red", 4]
	]
};
tiepunisher.img = new Image();
tiepunisher.img.src = "images/tiepunisher.png";

var tiefofighter = {
	faction: "empire",
	id: "tiefofighter",
	base: smallbase,
	protrusions: 1,
	width: 40,
	height: 42,
	actions: ["roll"],
	slots: [],
	decloak: [],
	dial: [
		["turn", "white", 1, -1],
		["turn", "white", 1, 1],
		["turn", "green", 2, -1],
		["bank", "green", 2, -1],
		["straight", "green", 2],
		["bank", "green", 2, 1],
		["turn", "green", 2, 1],
		["segnors", "red", 2, -1],
		["segnors", "red", 2, 1],
		["turn", "white", 3, -1],
		["bank", "white", 3, -1],
		["straight", "green", 3],
		["bank", "white", 3, 1],
		["turn", "white", 3, 1],
		["straight", "white", 4],
		["koiogran", "red", 4],
		["straight", "white", 5]
	]
};
tiefofighter.img = new Image();
tiefofighter.img.src = "images/tiefofighter.png";

var tiesffighter = {
	faction: "empire",
	id: "tiesffighter",
	base: smallbase,
	protrusions: 1,
	width: 40,
	height: 42,
	actions: ["roll"],
	slots: ["system"],
	arc: "rear",
	decloak: [],
	dial: [
		["turn", "red", 1, -1],
		["bank", "green", 1, -1],
		["straight", "green", 1],
		["bank", "green", 1, 1],
		["turn", "red", 1, 1],
		["turn", "white", 2, -1],
		["bank", "white", 2, -1],
		["straight", "green", 2],
		["bank", "white", 2, 1],
		["turn", "white", 2, 1],
		["turn", "red", 3, -1],
		["bank", "white", 3, -1],
		["straight", "green", 3],
		["bank", "white", 3, 1],
		["turn", "red", 3, 1],
		["segnors", "red", 3, -1],
		["segnors", "red", 3, 1],
		["straight", "white", 4]
	]
};
tiesffighter.img = new Image();
tiesffighter.img.src = "images/tiesffighter.png";

var decimator = {
	faction: "empire",
	id: "decimator",
	base: largebase,
	protrusions: 36,
	offset: 4,
	width: 90,
	height: 134,
	actions: [],
	slots: ["crew"],
	arc: "turret",
	decloak: [],
	dial: [
		["bank", "white", 1, -1],
		["straight", "white", 1],
		["bank", "white", 1, 1],
		["turn", "white", 2, -1],
		["bank", "green", 2, -1],
		["straight", "green", 2],
		["bank", "green", 2, 1],
		["turn", "white", 2, 1],
		["turn", "white", 3, -1],
		["bank", "white", 3, -1],
		["straight", "green", 3],
		["bank", "white", 3, 1],
		["turn", "white", 3, 1],
		["straight", "white", 4]
	]
};
decimator.img = new Image();
decimator.img.src = "images/decimator.png";

var firespray = {
	faction: "empire",
	id: "firespray",
	base: largebase,
	protrusions: 1,
	offset: 5,
	width: 90,
	height: 82,
	actions: [],
	slots: ["crew"],
	arc: "rear",
	decloak: [],
	dial: [
		["bank", "green", 1, -1],
		["straight", "green", 1],
		["bank", "green", 1, 1],
		["turn", "white", 2, -1],
		["bank", "white", 2, -1],
		["straight", "green", 2],
		["bank", "white", 2, 1],
		["turn", "white", 2, 1],
		["turn", "white", 3, -1],
		["bank", "white", 3, -1],
		["straight", "white", 3],
		["bank", "white", 3, 1],
		["turn", "white", 3, 1],
		["koiogran", "red", 3],
		["straight", "white", 4],
		["koiogran", "red", 4]
	]
};
firespray.img = new Image();
firespray.img.src = "images/firespray.png";

var lambda = {
	faction: "empire",
	id: "lambda",
	base: largebase,
	protrusions: 4,
	offset: 21,
	width: 124,
	height: 85,
	actions: [],
	slots: ["system", "crew"],
	decloak: [],
	dial: [
		["bank", "green", 1, -1],
		["straight", "green", 1],
		["bank", "green", 1, 1],
		["turn", "red", 2, -1],
		["bank", "white", 2, -1],
		["straight", "green", 2],
		["bank", "white", 2, 1],
		["turn", "red", 2, 1],
		["bank", "red", 3, -1],
		["straight", "white", 3],
		["bank", "red", 3, 1]
	]
};
lambda.img = new Image();
lambda.img.src = "images/lambda.png";

var awing = {
	faction: "alliance",
	id: "awing",
	base: smallbase,
	protrusions: 1,
	width: 40,
	height: 42,
	actions: ["boost"],
	slots: [],
	decloak: [],
	dial: [
		["turn", "white", 1, -1],
		["turn", "white", 1, 1],
		["turn", "green", 2, -1],
		["bank", "green", 2, -1],
		["straight", "green", 2],
		["bank", "green", 2, 1],
		["turn", "green", 2, 1],
		["turn", "white", 3, -1],
		["bank", "white", 3, -1],
		["straight", "green", 3],
		["bank", "white", 3, 1],
		["turn", "white", 3, 1],
		["koiogran", "red", 3],
		["straight", "green", 4],
		["straight", "green", 5],
		["koiogran", "red", 5]
	]
};
awing.img = new Image();
awing.img.src = "images/awing.png";

var bwing = {
	faction: "alliance",
	id: "bwing",
	base: smallbase,
	protrusions: 1,
	width: 40,
	height: 42,
	actions: ["roll"],
	slots: ["system"],
	decloak: [],
	dial: [
		["turn", "red", 1, -1],
		["bank", "green", 1, -1],
		["straight", "green", 1],
		["bank", "green", 1, 1],
		["turn", "red", 1, 1],
		["turn", "white", 2, -1],
		["bank", "white", 2, -1],
		["straight", "green", 2],
		["bank", "white", 2, 1],
		["turn", "white", 2, 1],
		["koiogran", "red", 2],
		["bank", "red", 3, -1],
		["straight", "white", 3],
		["bank", "red", 3, 1],
		["straight", "red", 4]
]
};
bwing.img = new Image();
bwing.img.src = "images/bwing.png";

var ewing = {
	faction: "alliance",
	id: "ewing",
	base: smallbase,
	protrusions: 6,
	width: 40,
	height: 47,
	actions: ["roll"],
	slots: ["system", "astromech"],
	decloak: [],
	dial: [
		["bank", "white", 1, -1],
		["straight", "green", 1],
		["bank", "white", 1, 1],
		["turn", "white", 2, -1],
		["bank", "green", 2, -1],
		["straight", "green", 2],
		["bank", "green", 2, 1],
		["turn", "white", 2, 1],
		["turn", "white", 3, -1],
		["bank", "white", 3, -1],
		["straight", "green", 3],
		["bank", "white", 3, 1],
		["turn", "white", 3, 1],
		["koiogran", "red", 3],
		["straight", "white", 4],
		["koiogran", "red", 4],
		["straight", "white", 5]
]
};
ewing.img = new Image();
ewing.img.src = "images/ewing.png";

var kwing = {
	faction: "alliance",
	id: "kwing",
	base: smallbase,
	protrusions: 18,
	offset: 35,
	width: 110,
	height: 69,
	actions: ["slam"],
	slots: ["crew"],
	arc: "turret",
	decloak: [],
	dial: [
		["bank", "green", 1, -1],
		["straight", "green", 1],
		["bank", "green", 1, 1],
		["turn", "white", 2, -1],
		["bank", "white", 2, -1],
		["straight", "green", 2],
		["bank", "white", 2, 1],
		["turn", "white", 2, 1],
		["bank", "white", 3, -1],
		["straight", "white", 3],
		["bank", "white", 3, 1]
]
};
kwing.img = new Image();
kwing.img.src = "images/kwing.png";

var xwing = {
	faction: "alliance",
	id: "xwing",
	base: smallbase,
	protrusions: 8,
	width: 40,
	height: 49,
	actions: [],
	slots: ["astromech"],
	decloak: [],
	dial: [
		["bank", "green", 1, -1],
		["straight", "green", 1],
		["bank", "green", 1, 1],
		["turn", "white", 2, -1],
		["bank", "white", 2, -1],
		["straight", "green", 2],
		["bank", "white", 2, 1],
		["turn", "white", 2, 1],
		["turn", "white", 3, -1],
		["bank", "white", 3, -1],
		["straight", "white", 3],
		["bank", "white", 3, 1],
		["turn", "white", 3, 1],
		["straight", "white", 4],
		["koiogran", "red", 4]
	]
};
xwing.img = new Image();
xwing.img.src = "images/xwing.png";

var ywing = {
	faction: "alliance",
	id: "ywing",
	base: smallbase,
	protrusions: 8,
	width: 40,
	height: 58,
	actions: [],
	slots: ["astromech"],
	arc: "turret",
	decloak: [],
	dial: [
		["bank", "white", 1, -1],
		["straight", "green", 1],
		["bank", "white", 1, 1],
		["turn", "white", 2, -1],
		["bank", "white", 2, -1],
		["straight", "green", 2],
		["bank", "white", 2, 1],
		["turn", "white", 2, 1],
		["turn", "red", 3, -1],
		["bank", "white", 3, -1],
		["straight", "white", 3],
		["bank", "white", 3, 1],
		["turn", "red", 3, 1],
		["straight", "red", 4],
		["koiogran", "red", 4]
	]
};
ywing.img = new Image();
ywing.img.src = "images/ywing.png";

var z95 = {
	faction: "alliance",
	id: "z95",
	base: smallbase,
	protrusions: 8,
	width: 40,
	height: 49,
	actions: [],
	slots: [],
	decloak: [],
	dial: [
		["bank", "white", 1, -1],
		["straight", "green", 1],
		["bank", "white", 1, 1],
		["turn", "white", 2, -1],
		["bank", "green", 2, -1],
		["straight", "green", 2],
		["bank", "green", 2, 1],
		["turn", "white", 2, 1],
		["turn", "white", 3, -1],
		["bank", "white", 3, -1],
		["straight", "white", 3],
		["bank", "white", 3, 1],
		["turn", "white", 3, 1],
		["koiogran", "red", 3],
		["straight", "white", 4]
	]
};
z95.img = new Image();
z95.img.src = "images/z95.png";

var attackshuttle = {
	faction: "alliance",
	id: "attackshuttle",
	base: smallbase,
	protrusions: 4,
	width: 40,
	height: 45,
	actions: ["roll"],
	slots: ["crew"],
	arc: "turret",
	decloak: [],
	dial: [
		["turn", "red", 1, -1],
		["bank", "green", 1, -1],
		["straight", "green", 1],
		["bank", "green", 1, 1],
		["turn", "red", 1, 1],
		["turn", "white", 2, -1],
		["bank", "white", 2, -1],
		["straight", "green", 2],
		["bank", "white", 2, 1],
		["turn", "white", 2, 1],
		["turn", "red", 3, -1],
		["bank", "white", 3, -1],
		["straight", "white", 3],
		["bank", "white", 3, 1],
		["turn", "red", 3, 1],
		["straight", "white", 4],
		["koiogran", "red", 4]
	]
};
attackshuttle.img = new Image();
attackshuttle.img.src = "images/attackshuttle.png";

var hwk = {
	faction: "alliance",
	id: "hwk",
	base: smallbase,
	protrusions: 12,
	offset: 3,
	width: 46,
	height: 56,
	actions: [],
	slots: ["crew"],
	arc: "turret",
	decloak: [],
	dial: [
		["bank", "green", 1, -1],
		["straight", "green", 1],
		["bank", "green", 1, 1],
		["turn", "white", 2, -1],
		["bank", "white", 2, -1],
		["straight", "green", 2],
		["bank", "white", 2, 1],
		["turn", "white", 2, 1],
		["bank", "red", 3, -1],
		["straight", "white", 3],
		["bank", "red", 3, 1],
		["straight", "red", 4]
	]
};
hwk.img = new Image();
hwk.img.src = "images/hwk.png";

var t70xwing = {
	faction: "alliance",
	id: "t70xwing",
	base: smallbase,
	protrusions: 8,
	offset: 1,
	width: 42,
	height: 49,
	actions: ["boost"],
	slots: ["astromech"],
	decloak: [],
	dial: [
		["bank", "green", 1, -1],
		["straight", "green", 1],
		["bank", "green", 1, 1],
		["turn", "white", 2, -1],
		["bank", "white", 2, -1],
		["straight", "green", 2],
		["bank", "white", 2, 1],
		["turn", "white", 2, 1],
		["turn", "white", 3, -1],
		["bank", "white", 3, -1],
		["straight", "green", 3],
		["bank", "white", 3, 1],
		["turn", "white", 3, 1],
		["tallon", "red", 3, -1],
		["tallon", "red", 3, 1],
		["straight", "white", 4],
		["koiogran", "red", 4]
	]
};
t70xwing.img = new Image();
t70xwing.img.src = "images/t70xwing.png";

var vcx100 = {
	faction: "alliance",
	id: "vcx100",
	base: largebase,
	protrusions: 27,
	offset: 20,
	width: 120,
	height: 155,
	actions: [],
	slots: ["crew", "system"],
	arc: "turret",
	decloak: [],
	dial: [
		["turn", "red", 1, -1],
		["bank", "white", 1, -1],
		["straight", "green", 1],
		["bank", "white", 1, 1],
		["turn", "red", 1, 1],
		["turn", "white", 2, -1],
		["bank", "green", 2, -1],
		["straight", "green", 2],
		["bank", "green", 2, 1],
		["turn", "white", 2, 1],
		["turn", "red", 3, -1],
		["bank", "white", 3, -1],
		["straight", "white", 3],
		["bank", "white", 3, 1],
		["turn", "red", 3, 1],
		["straight", "white", 4],
		["koiogran", "red", 5]
	]
};
vcx100.img = new Image();
vcx100.img.src = "images/vcx100.png";

var yt1300 = {
	faction: "alliance",
	id: "yt1300",
	base: largebase,
	protrusions: 32,
	offset: 3,
	width: 88,
	height: 119,
	actions: [],
	slots: ["crew"],
	arc: "turret",
	decloak: [],
	dial: [
		["turn", "white", 1, -1],
		["bank", "green", 1, -1],
		["straight", "green", 1],
		["bank", "green", 1, 1],
		["turn", "white", 1, 1],
		["turn", "white", 2, -1],
		["bank", "white", 2, -1],
		["straight", "green", 2],
		["bank", "white", 2, 1],
		["turn", "white", 2, 1],
		["bank", "white", 3, -1],
		["straight", "white", 3],
		["bank", "white", 3, 1],
		["koiogran", "red", 3],
		["segnors", "red", 3, -1],
		["segnors", "red", 3, 1],
		["straight", "white", 4],
		["koiogran", "red", 4]
	]
};
yt1300.img = new Image();
yt1300.img.src = "images/yt1300.png";

var yt2400 = {
	faction: "alliance",
	id: "yt2400",
	base: largebase,
	protrusions: 1,
	offset: 10,
	width: 100,
	height: 82,
	actions: ["roll"],
	slots: ["crew"],
	arc: "turret",
	decloak: [],
	dial: [
		["turn", "white", 1, -1],
		["bank", "green", 1, -1],
		["straight", "green", 1],
		["bank", "green", 1, 1],
		["turn", "white", 1, 1],
		["turn", "white", 2, -1],
		["bank", "white", 2, -1],
		["straight", "green", 2],
		["bank", "white", 2, 1],
		["turn", "white", 2, 1],
		["turn", "white", 3, -1],
		["bank", "white", 3, -1],
		["straight", "white", 3],
		["bank", "white", 3, 1],
		["turn", "white", 3, 1],
		["straight", "white", 4],
		["koiogran", "red", 4]
	]
};
yt2400.img = new Image();
yt2400.img.src = "images/yt2400.png";

var g1a = {
	faction: "scum",
	id: "g1a",
	base: smallbase,
	protrusions: 12,
	width: 40,
	height: 59,
	actions: ["roll"],
	slots: ["crew", "illicit", "system"],
	decloak: [
		["straight", "blue", 2],
		["roll", "blue", 2, -1, 1],
		["roll", "blue", 2, 1, 1],
		["roll", "blue", 2, -1, -1],
		["roll", "blue", 2, 1, -1]
	],
	dial: [
		["turn", "red", 1, -1],
		["bank", "green", 1, -1],
		["straight", "green", 1],
		["bank", "green", 1, 1],
		["turn", "red", 1, 1],
		["turn", "white", 2, -1],
		["bank", "white", 2, -1],
		["straight", "green", 2],
		["bank", "white", 2, 1],
		["turn", "white", 2, 1],
		["bank", "red", 3, -1],
		["straight", "green", 3],
		["bank", "red", 3, 1],
		["koiogran", "red", 3],
		["straight", "white", 4],
		["koiogran", "red", 4]
	]
};
g1a.img = new Image();
g1a.img.src = "images/g1a.png";

var Shwk = {
	faction: "scum",
	id: "Shwk",
	base: smallbase,
	img: hwk.img,
	protrusions: 12,
	offset: 3,
	width: 46,
	height: 56,
	actions: [],
	slots: ["crew", "illicit"],
	arc: "turret",
	decloak: [
		["straight", "blue", 2],
		["roll", "blue", 2, -1, 1],
		["roll", "blue", 2, 1, 1],
		["roll", "blue", 2, -1, -1],
		["roll", "blue", 2, 1, -1]
	],
	dial: [
		["bank", "green", 1, -1],
		["straight", "green", 1],
		["bank", "green", 1, 1],
		["turn", "white", 2, -1],
		["bank", "white", 2, -1],
		["straight", "green", 2],
		["bank", "white", 2, 1],
		["turn", "white", 2, 1],
		["bank", "red", 3, -1],
		["straight", "white", 3],
		["bank", "red", 3, 1],
		["straight", "red", 4]
	]
};

var kihraxz = {
	faction: "scum",
	id: "kihraxz",
	base: smallbase,
	protrusions: 11,
	width: 40,
	height: 52,
	actions: [],
	slots: ["illicit"],
	decloak: [
		["straight", "blue", 2],
		["roll", "blue", 2, -1, 1],
		["roll", "blue", 2, 1, 1],
		["roll", "blue", 2, -1, -1],
		["roll", "blue", 2, 1, -1]
	],
	dial: [
		["turn", "white", 1, -1],
		["bank", "green", 1, -1],
		["bank", "green", 1, 1],
		["turn", "white", 1, 1],
		["turn", "white", 2, -1],
		["bank", "green", 2, -1],
		["straight", "green", 2],
		["bank", "green", 2, 1],
		["turn", "white", 2, 1],
		["bank", "white", 3, -1],
		["straight", "white", 3],
		["bank", "white", 3, 1],
		["straight", "white", 4],
		["koiogran", "red", 4],
		["koiogran", "red", 5]
	]
};
kihraxz.img = new Image();
kihraxz.img.src = "images/kihraxz.png";

var scyk = {
	faction: "scum",
	id: "scyk",
	base: smallbase,
	protrusions: 1,
	width: 40,
	height: 53,
	actions: ["roll"],
	slots: [],
	decloak: [],
	dial: [
		["turn", "white", 1, -1],
		["bank", "green", 1, -1],
		["bank", "green", 1, 1],
		["turn", "white", 1, 1],
		["turn", "white", 2, -1],
		["bank", "green", 2, -1],
		["straight", "green", 2],
		["bank", "green", 2, 1],
		["turn", "white", 2, 1],
		["bank", "white", 3, -1],
		["straight", "green", 3],
		["bank", "white", 3, 1],
		["koiogran", "red", 3],
		["straight", "white", 4],
		["koiogran", "red", 5]
	]
};
scyk.img = new Image();
scyk.img.src = "images/scyk.png";

var starviper = {
	faction: "scum",
	id: "starviper",
	base: smallbase,
	protrusions: 1,
	offset: 8,
	width: 55,
	height: 45,
	actions: ["roll", "boost"],
	slots: ["system", "illicit"],
	decloak: [
		["straight", "blue", 2],
		["roll", "blue", 2, -1, 1],
		["roll", "blue", 2, 1, 1],
		["roll", "blue", 2, -1, -1],
		["roll", "blue", 2, 1, -1]
	],
	dial: [
		["turn", "white", 1, -1],
		["bank", "green", 1, -1],
		["straight", "green", 1],
		["bank", "green", 1, 1],
		["turn", "white", 1, 1],
		["turn", "white", 2, -1],
		["bank", "white", 2, -1],
		["straight", "green", 2],
		["bank", "white", 2, 1],
		["turn", "white", 2, 1],
		["bank", "white", 3, -1],
		["straight", "green", 3],
		["bank", "white", 3, 1],
		["segnors", "red", 3, -1],
		["segnors", "red", 3, 1],
		["straight", "white", 4]
	]
};
starviper.img = new Image();
starviper.img.src = "images/starviper.png";

var Sywing = {
	faction: "scum",
	id: "Sywing",
	base: smallbase,
	protrusions: 8,
	width: 40,
	height: 59,
	actions: [],
	slots: ["salvaged astromech"],
	arc: "turret",
	decloak: [],
	dial: [
		["bank", "white", 1, -1],
		["straight", "green", 1],
		["bank", "white", 1, 1],
		["turn", "white", 2, -1],
		["bank", "white", 2, -1],
		["straight", "green", 2],
		["bank", "white", 2, 1],
		["turn", "white", 2, 1],
		["turn", "red", 3, -1],
		["bank", "white", 3, -1],
		["straight", "white", 3],
		["bank", "white", 3, 1],
		["turn", "red", 3, 1],
		["straight", "red", 4],
		["koiogran", "red", 4]
	]
};
Sywing.img = new Image();
Sywing.img.src = "images/ywing-s.png";

var Sz95 = {
	faction: "scum",
	id: "Sz95",
	base: smallbase,
	protrusions: 8,
	width: 40,
	height: 49,
	actions: [],
	slots: ["illicit"],
	decloak: [
		["straight", "blue", 2],
		["roll", "blue", 2, -1, 1],
		["roll", "blue", 2, 1, 1],
		["roll", "blue", 2, -1, -1],
		["roll", "blue", 2, 1, -1]
	],
	dial: [
		["bank", "white", 1, -1],
		["straight", "green", 1],
		["bank", "white", 1, 1],
		["turn", "white", 2, -1],
		["bank", "green", 2, -1],
		["straight", "green", 2],
		["bank", "green", 2, 1],
		["turn", "white", 2, 1],
		["turn", "white", 3, -1],
		["bank", "white", 3, -1],
		["straight", "white", 3],
		["bank", "white", 3, 1],
		["turn", "white", 3, 1],
		["koiogran", "red", 3],
		["straight", "white", 4]
	]
};
Sz95.img = new Image();
Sz95.img.src = "images/z95-s.png";

var aggressor = {
	faction: "scum",
	id: "aggressor",
	base: largebase,
	protrusions: 7,
	width: 80,
	height: 88,
	actions: ["boost"],
	slots: ["system", "illicit"],
	decloak: [],
	dial: [
		["turn", "white", 1, -1],
		["bank", "green", 1, -1],
		["straight", "green", 1],
		["bank", "green", 1, 1],
		["turn", "white", 1, 1],
		["turn", "white", 2, -1],
		["bank", "green", 2, -1],
		["straight", "green", 2],
		["bank", "green", 2, 1],
		["turn", "white", 2, 1],
		["bank", "green", 3, -1],
		["straight", "green", 3],
		["bank", "green", 3, 1],
		["segnors", "red", 3, -1],
		["segnors", "red", 3, 1],
		["koiogran", "red", 4]
	]
};
aggressor.img = new Image();
aggressor.img.src = "images/aggressor.png";

var Sfirespray = {
	faction: "scum",
	id: "Sfirespray",
	img: firespray.img,
	base: largebase,
	protrusions: 1,
	offset: 5,
	width: 90,
	height: 82,
	actions: [],
	slots: ["crew", "illicit"],
	arc: "rear",
	decloak: [],
	dial: [
		["bank", "green", 1, -1],
		["straight", "green", 1],
		["bank", "green", 1, 1],
		["turn", "white", 2, -1],
		["bank", "white", 2, -1],
		["straight", "green", 2],
		["bank", "white", 2, 1],
		["turn", "white", 2, 1],
		["turn", "white", 3, -1],
		["bank", "white", 3, -1],
		["straight", "white", 3],
		["bank", "white", 3, 1],
		["turn", "white", 3, 1],
		["koiogran", "red", 3],
		["straight", "white", 4],
		["koiogran", "red", 4]
	]
};

var jumpmaster5000 = {
	faction: "scum",
	id: "jumpmaster5000",
	base: largebase,
	protrusions: 1,
	offset: 5,
	width: 85,
	height: 82,
	actions: ["roll"],
	slots: ["crew", "salvaged astromech", "illicit"],
	arc: "turret",
	decloak: [],
	dial: [
		["turn", "green", 1, -1],
		["bank", "green", 1, -1],
		["straight", "green", 1],
		["bank", "white", 1, 1],
		["turn", "white", 1, 1],
		["turn", "green", 2, -1],
		["bank", "green", 2, -1],
		["straight", "green", 2],
		["bank", "white", 2, 1],
		["turn", "white", 2, 1],
		["segnors", "white", 2, -1],
		["segnors", "red", 2, 1],
		["bank", "white", 3, -1],
		["straight", "white", 3],
		["bank", "white", 3, 1],
		["straight", "white", 4],
		["koiogran", "red", 4]
	]
};
jumpmaster5000.img = new Image();
jumpmaster5000.img.src = "images/jumpmaster5000.png";

var yv666 = {
	faction: "scum",
	id: "yv666",
	base: largebase,
	protrusions: 66,
	offset: 30,
	width: 136,
	height: 201,
	actions: [],
	slots: ["crew", "illicit"],
	arc: "180",
	decloak: [],
	dial: [
		["bank", "green", 1, -1],
		["straight", "green", 1],
		["bank", "green", 1, 1],
		["turn", "red", 2, -1],
		["bank", "white", 2, -1],
		["straight", "green", 2],
		["bank", "white", 2, 1],
		["turn", "red", 2, 1],
		["turn", "white", 3, -1],
		["bank", "white", 3, -1],
		["straight", "green", 3],
		["bank", "white", 3, 1],
		["turn", "white", 3, 1],
		["straight", "white", 4]
	]
};
yv666.img = new Image();
yv666.img.src = "images/yv666.png";

var shipIndex = {
//Galactic Empire
	"decimator": decimator,
	"firespray": firespray,
	"lambda": lambda,
	"tieadvanced": tieadvanced,
	"junoeclipse": junoeclipse,
	"tieadvprototype": tieadvprototype,
	"tiebomber": tiebomber,
	"tiedefender": tiedefender,
	"countessryad": countessryad,
	"tiefighter": tiefighter,
	"tieinterceptor": tieinterceptor,
	"tiephantom": tiephantom,
	"echo": echo,
	"tiepunisher": tiepunisher,
	"tiefofighter": tiefofighter,
	"tiesffighter": tiesffighter,
//Rebel Alliance
	"attackshuttle": attackshuttle,
	"awing": awing,
	"bwing": bwing,
	"ewing": ewing,
	"hwk": hwk,
	"kwing": kwing,
	"t70xwing": t70xwing,
	"vcx100": vcx100,
	"xwing": xwing,
	"yt1300": yt1300,
	"yt2400": yt2400,
	"ywing": ywing,
	"z95": z95,
//Scum and Villainy
	"aggressor": aggressor,
	"Sfirespray": Sfirespray,
	"g1a": g1a,
	"Shwk": Shwk,
	"jumpmaster5000": jumpmaster5000,
	"kihraxz": kihraxz,
	"scyk": scyk,
	"starviper": starviper,
	"yv666": yv666,
	"Sywing": Sywing,
	"Sz95": Sz95
};

var ship = new Object();

var decloak;
var dial;

var timer = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
var queued = false;
var barrel_roll_timer = [0, 0];
var boost_timer = [0, 0];
var slam_timer = [0, 0];
var bbPTL_timer = [0, 0];
var stepOverride = false;

var remnant = 0.3;

var fRoll = [false, false, false, false];
var fBoost = [false, false, false];

var wharrgarbl = -1;

function initialize () {
	select(tiephantom, echo);
	gridlayer = document.getElementById("gridlayer");
	gridlayer.style.zIndex = -1;
	layer0 = document.getElementById("layer0");
	layer0.style.zIndex = 0;
	layer1 = document.getElementById("layer1");
	layer1.style.zIndex = 3;
	layer2 = document.getElementById("layer2");
	layer2.style.zIndex = 4;
	layer3 = document.getElementById("layer3");
	layer3.style.zIndex = 7;
	ctx = [layer0.getContext("2d"), layer1.getContext("2d"), layer2.getContext("2d"), layer3.getContext("2d")];
	gctx = gridlayer.getContext("2d")
	starfield();
	setInterval(function(){step()}, 35);
	if (location.search.length > 1) {
		loadState(location.search.substr(1).split("&"));
	};
};

function loadState (stateArray) {
	if (shipIndex[stateArray[0]].faction != "empire") {
		select(shipIndex[stateArray[0]].faction);
	};
	if (stateArray[1] && (shipIndex[stateArray[0]].pilots == undefined || shipIndex[stateArray[0]].pilots.indexOf(stateArray[1]) == -1)) {
		stateArray[1] = undefined;
	};
	select(shipIndex[stateArray[0]], shipIndex[stateArray[1]]);
	if (stateArray[2]) {
		var decloaks = stateArray[2].split(",");
		if (stateArray[0] == "tiephantom") {
			setDecloak("all");
		};
		if (stateArray[1] != "echo") {
			for (var i = 0; i < decloaks.length; i++) {
				setDecloak("p", decloaks[i]);
			};
		} else {
			for (var i = 0; i < decloaks.length; i++) {
				if (decloaks[i] < 2) {
					setDecloak("e", decloaks[i]);
				} else {
					setDecloak("e", decloaks[i], Number(decloaks[i]) + 1);
				};
			};
		};
	};
	if (stateArray[3]) {
		var maneuvers = stateArray[3].split(",");
		setDial("all");
		for (var i = 0; i < maneuvers.length; i++) {
			var mType = ["Turn", "Turn", "Bank", "Bank", "Straight", "Koiogran", "Segnors", "Segnors", "Tallon", "Tallon"][i];
			var mSuffix = "";
			if ([0, 2, 6, 8].indexOf(i) != -1) {
				mSuffix = "l";
			} else if ([1, 3, 7, 9].indexOf(i) != -1) {
				mSuffix = "r";
			};
			if ([1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25, 27, 29, 31].indexOf(Number(maneuvers[i])) != -1) {
				setDial("b" + mType + "1" + mSuffix);
			};
			if ([2, 3, 6, 7, 10, 11, 14, 15, 18, 19, 22, 23, 26, 27, 30, 31].indexOf(Number(maneuvers[i])) != -1) {
				setDial("b" + mType + "2" + mSuffix);
			};
			if ([4, 5, 6, 7, 12, 13, 14, 15, 20, 21, 22, 23, 28, 29, 30, 31].indexOf(Number(maneuvers[i])) != -1) {
				setDial("b" + mType + "3" + mSuffix);
			};
			if ([8, 9, 10, 11, 12, 13, 14, 15, 24, 25, 26, 27, 28, 29, 30, 31].indexOf(Number(maneuvers[i])) != -1) {
				setDial("b" + mType + "4" + mSuffix);
			};
			if ([16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31].indexOf(Number(maneuvers[i])) != -1) {
				setDial("b" + mType + "5" + mSuffix);
			};
		};
	};
	if (stateArray[4]) {
		if ([1, 3, 5, 7, 11, 17, 19, 27].indexOf(Number(stateArray[4])) != -1) {
			barrel_roll();
		};
		if ([2, 3, 6, 7, 11, 18, 19, 27].indexOf(Number(stateArray[4])) != -1) {
			boost();
		};
		if ([4, 5, 6, 7].indexOf(Number(stateArray[4])) != -1) {
			slam();
		};
		if ([11, 27].indexOf(Number(stateArray[4])) != -1) {
			bbPTL();
		};
		if ([17, 18, 19, 27].indexOf(Number(stateArray[4])) != -1) {
			advSensors();
		};
	};
	if (stateArray[5]) {
		for (var i = 0; i < Number(stateArray[5]); i++) {
			gridfield();
		};
	};
	if (stateArray[6]) {
		starfield();
	};
	if (stateArray[7]) {
		loop();
	};
	if (stateArray[8]) {
		for (var i = 0; i < Number(stateArray[8]); i++) {
			fire();
		};
	};
	if (stateArray[9]) {
		transparent();
	};
};

function saveState () {
	var url = location.href.split("?")[0];
	var strShip = ship.id + "&";
	if (shipIndex[ship.id].vessel) {
		strShip = shipIndex[ship.id].vessel.id + "&" + ship.id;
	};
	var arrDecloak = [];
	if (decloak != undefined) {
		for (var i = 0; i < decloak.length; i++) {
			switch (decloak[i][0]) {
				case "straight":
					arrDecloak.push(0);
					break;
				case "roll":
					if (decloak[i][3] == -1 && decloak[i][4] == 1) {
						arrDecloak.push(1);
					};
					if (decloak[i][3] == 1 && decloak[i][4] == 1) {
						arrDecloak.push(2);
					};
					if (decloak[i][3] == -1 && decloak[i][4] == -1) {
						arrDecloak.push(3);
					};
					if (decloak[i][3] == 1 && decloak[i][4] == -1) {
						arrDecloak.push(4);
					};
					break;
				case "bank":
					if (decloak[i][3] == -1) {
						arrDecloak.push(0);
					};
					if (decloak[i][3] == 1) {
						arrDecloak.push(1);
					};
					break;
				case "bankroll":
					if (decloak[i][3] == -1 && decloak[i][4] == 1 && decloak[i][5] == 1) {
						arrDecloak.push(2);
					};
					if (decloak[i][3] == 1 && decloak[i][4] == 1 && decloak[i][5] == -1) {
						arrDecloak.push(4);
					};
					if (decloak[i][3] == -1 && decloak[i][4] == 1  && decloak[i][5] == -1) {
						arrDecloak.push(6);
					};
					if (decloak[i][3] == 1 && decloak[i][4] == 1  && decloak[i][5] == 1) {
						arrDecloak.push(8);
					};
					break;
			};
		};
	};
	var strDecloak = arrDecloak.join();
	var arrManeuvers = [];
	if (dial != undefined && ship.dial.length != dial.length) {
		arrManeuvers = [0,0,0,0,0,0,0,0,0,0];
		for (var i = 0; i < dial.length; i++) {
			switch (dial[i][0]) {
				case "turn":
					if (dial[i][3] == -1) {
						arrManeuvers[0] += Math.pow(2, dial[i][2] - 1);
					};
					if (dial[i][3] == 1) {
						arrManeuvers[1] += Math.pow(2, dial[i][2] - 1);
					};
					break;
				case "bank":
					if (dial[i][3] == -1) {
						arrManeuvers[2] += Math.pow(2, dial[i][2] - 1);
					};
					if (dial[i][3] == 1) {
						arrManeuvers[3] += Math.pow(2, dial[i][2] - 1);
					};
					break;
				case "straight":
					arrManeuvers[4] += Math.pow(2, dial[i][2] - 1);
					break;
				case "koiogran":
					arrManeuvers[5] += Math.pow(2, dial[i][2] - 1);
					break;
				case "segnors":
					if (dial[i][3] == -1) {
						arrManeuvers[6] += Math.pow(2, dial[i][2] - 1);
					};
					if (dial[i][3] == 1) {
						arrManeuvers[7] += Math.pow(2, dial[i][2] - 1);
					};
					break;
				case "tallon":
					if (dial[i][3] == -1) {
						arrManeuvers[8] += Math.pow(2, dial[i][2] - 1);
					};
					if (dial[i][3] == 1) {
						arrManeuvers[9] += Math.pow(2, dial[i][2] - 1);
					};
					break;
			};
		};
	};
	while(arrManeuvers[arrManeuvers.length - 1] === 0 && arrManeuvers.length > 1) {
		arrManeuvers.pop();
	};
	var strManeuvers = arrManeuvers.join();
	var intActions = 0;
	if (document.getElementById("button_barrel").style.opacity == 0) {
		intActions += 1;
	};
	if (document.getElementById("button_boost").style.opacity == 0) {
		intActions += 2;
	};
	if (document.getElementById("button_slam").style.opacity == 0) {
		intActions += 4;
	};
	if (document.getElementById("button_bbPTL").style.opacity == 0) {
		intActions += 8;
	};
	if (document.getElementById("button_sensors").style.opacity == 0) {
		intActions += 16;
	};
	var strGrid = document.getElementById("grid_level").innerHTML;
	var strStars = (document.getElementById("option_starfield").style.opacity == 0) ? "" : 0;
	var strLoop = (document.getElementById("option_loop").style.opacity == 0) ? 1 : "";
	var strFire = document.getElementById("fire_range").innerHTML;
	var strTransparent = (document.getElementById("option_transparent").style.opacity == 0) ? 1 : "";
	url += "?" + strShip + "&" + strDecloak + "&" + strManeuvers + "&" + intActions + "&" + strGrid + "&" + strStars + "&" + strLoop + "&" + strFire + "&" + strTransparent;
	url = url.replace(/&+$/g, "");
	document.getElementById("permalink").href = url;
};

function select (model, pilot) {
	var selections = document.getElementsByClassName("select");
	for (var i = 0; i < selections.length; i++) {
		document.getElementsByClassName("select")[i].style.color = "#116699";
	};
	if (model == "empire" || model == "alliance" || model == "scum") {
		var enemies = ["alliance", "empire", "scum"];
		enemies.splice(enemies.indexOf(model), 1);
		var faction = document.getElementsByClassName(model);
		var eFactions = [document.getElementsByClassName(enemies[0]), document.getElementsByClassName(enemies[1])];
		var target = document.getElementById("select_" + model);
		var eTargets = [document.getElementById("select_" + enemies[0]), document.getElementById("select_" + enemies[1])];
		var state = target.style.opacity;
		if (state == 1) {
			for (var i = 0; i < faction.length; i++) {
				faction[i].hidden = true;
			};
			target.style.opacity = 0.3;
		} else {
			for (var i = 0; i < eFactions.length; i++) {
				for (var j = 0; j < eFactions[i].length; j++) {
					eFactions[i][j].hidden = true;
				};
			};
			for (var i = 0; i < faction.length; i++) {
				if (faction[i].className.indexOf("pilot") == -1 || ship.pilots.indexOf(faction[i].id.substr(7)) != -1) {
					faction[i].hidden = false;
				};
				if (faction[i].className.indexOf("pilot") != -1 && ship.id == faction[i].id.substr(7)) {
					document.getElementById("select_" + faction[i].id.substr(7)).style.color = "#11EEFF";
				};
			};
			eTargets[0].style.opacity = 0.3;
			eTargets[1].style.opacity = 0.3;
			target.style.opacity = 1;
		};
	} else {
		ship.faction = model.faction;
		ship.id = model.id;
		ship.pilots = (model.pilots == undefined) ? [] : model.pilots;
		var enemies = ["alliance", "empire", "scum"];
		enemies.splice(enemies.indexOf(ship.faction), 1);
		var faction = document.getElementsByClassName(ship.faction);
		var eFactions = [document.getElementsByClassName(enemies[0]), document.getElementsByClassName(enemies[1])];
		document.getElementById("select_" + enemies[0]).style.opacity = 0.3;
		document.getElementById("select_" + enemies[1]).style.opacity = 0.3;
		for (var i = 0; i < eFactions.length; i++) {
			for (var j = 0; j < eFactions[i].length; j++) {
				eFactions[i][j].hidden = true;
			};
		};
		for (var i = 0; i < faction.length; i++) {

			if (faction[i].className.search("pilot") == -1 || ship.pilots.indexOf(faction[i].id.substr(7)) != -1) {
				faction[i].hidden = false;
			} else {
				faction[i].hidden = true;
			};
		};
		var elite = false;
		if (pilot != undefined) {
			ship.id = pilot.id;
			document.getElementById("select_" + pilot.id).style.color = "#11EEFF";
			if (pilot.dial) {
				ship.dial = pilot.dial;
			} else {
				ship.dial = model.dial;
			};
			if (pilot.decloak) {
				ship.decloak = pilot.decloak;
			} else {
				ship.decloak = model.decloak;
			};
			document.getElementById("lock_sensors").innerHTML = (pilot.slots.indexOf("system") == -1) ? "&#x1F512;" : "";
			elite = (pilot.slots.indexOf("elite") == -1) ? false : true;
			document.getElementById("lock_bbPTL").innerHTML = (elite) ? "" : "E";
		} else {
			ship.dial = model.dial;
			ship.decloak = model.decloak;
			document.getElementById("lock_sensors").innerHTML = (model.slots.indexOf("system") == -1) ? "S" : "";
			elite = (model.slots.indexOf("elite") == -1) ? false : true;
			document.getElementById("lock_bbPTL").innerHTML = (elite) ?  "" : "E";
		};
		decloakTable(ship.decloak.length);
		maneuverTable(ship.dial);
		ship.img = model.img;
		ship.base = model.base;
		ship.arc = model.arc;
		ship.protrusions = (isFinite(model.protrusions)) ? model.protrusions : 0;;
		ship.offset = (isFinite(model.offset)) ? model.offset : 0;
		ship.width = model.width;
		ship.height = model.height;
		ship.actions = model.actions;
		document.getElementById("lock_roll").innerHTML = (model.actions.indexOf("roll") == -1 && !elite) ? "E" : "";
		document.getElementById("lock_boost").innerHTML = (model.actions.indexOf("boost") == -1) ? "M" : "";
		document.getElementById("button_slam").style.opacity = (model.actions.indexOf("slam") == -1) ? 1 : 0.5;
		decloak = undefined;
		dial = undefined;
		setDecloak("all");
		if (model.id != "tiephantom") {
			setDecloak("all");
		};
		setDial("all");
		timer_reset(true);
	};
};

function decloakTable (paths) {
	var decloakP = document.getElementsByClassName("decloakP");
	var decloakE = document.getElementsByClassName("decloakE");
	if (paths == 0) {
		tDecloak.hidden = true;
	} else {
		tDecloak.hidden = false;
		for (var i = 0; i < decloakE.length; i++) {
			decloakE[i].hidden = (paths == 10) ? false : true;
		};
		for (var i = 0; i < decloakP.length; i++) {
			decloakP[i].hidden = (paths == 5) ? false : true;
		};
	};
};

function maneuverTable (dial) {
	var range = [];
	for (var i = 1; i < 6; i++) {
		range[i] = [[0, 0], [0, 0], 0, 0, [0, 0], [0, 0]];
		for (var j = 0; j < dial.length; j++) {
			if (dial[j][2] == i) {
				switch (dial[j][0]) {
					case "turn":
						if (dial[j][3] == -1) {
							range[i][0][0] = dial[j][1];
						} else if (dial[j][3] == 1) {
							range[i][0][1] = dial[j][1];
						};
						break;
					case "bank":
						if (dial[j][3] == -1) {
							range[i][1][0] = dial[j][1];
						} else if (dial[j][3] == 1) {
							range[i][1][1] = dial[j][1];
						};
						break;
					case "straight":
						range[i][2] = dial[j][1];
						break;
					case "koiogran":
						range[i][3] = dial[j][1];
						break;
					case "segnors":
						if (dial[j][3] == -1) {
							range[i][4][0] = dial[j][1];
						} else if (dial[j][3] == 1) {
							range[i][4][1] = dial[j][1];
						};
						break;
					case "tallon":
						if (dial[j][3] == -1) {
							range[i][5][0] = dial[j][1];
						} else if (dial[j][3] == 1) {
							range[i][5][1] = dial[j][1];
						};
						break;
				}; 
			};
		};
		document.getElementById("mTurn" + i + "l").style.opacity = (range[i][0][0] == 0) ? 0 : 1;
		document.getElementById("mTurn" + i + "r").style.opacity = (range[i][0][0] == 0) ? 0 : 1;
		if (range[i][0][0] != 0) {
			document.getElementById("aTurn" + i + "l").src = "images/turn" + range[i][0][0].substr(0, 1).toUpperCase() + ".png";
			document.getElementById("aTurn" + i + "r").src = "images/turn" + range[i][0][1].substr(0, 1).toUpperCase() + ".png";
			document.getElementById("bTurn" + i + "l").onclick = function(){setDial(this.id)};
			document.getElementById("bTurn" + i + "r").onclick = function(){setDial(this.id)};
		} else {
			document.getElementById("bTurn" + i + "l").onclick = null;
			document.getElementById("bTurn" + i + "r").onclick = null;
		};
		document.getElementById("mBank" + i + "l").style.opacity = (range[i][1][0] == 0) ? 0 : 1;
		document.getElementById("mBank" + i + "r").style.opacity = (range[i][1][0] == 0) ? 0 : 1;
		if (range[i][1][0] != 0) {
			document.getElementById("aBank" + i + "l").src = "images/bank" + range[i][1][0].substr(0, 1).toUpperCase() + ".png";
			document.getElementById("aBank" + i + "r").src = "images/bank" + range[i][1][1].substr(0, 1).toUpperCase() + ".png";
			document.getElementById("bBank" + i + "l").onclick = function(){setDial(this.id)};
			document.getElementById("bBank" + i + "r").onclick = function(){setDial(this.id)};
		} else {
			document.getElementById("bBank" + i + "l").onclick = null;
			document.getElementById("bBank" + i + "r").onclick = null;
		};
		document.getElementById("mStraight" + i).style.opacity = (range[i][2] == 0) ? 0 : 1;
		if (range[i][2] != 0) {
			document.getElementById("aStraight" + i).src = "images/straight" + range[i][2].substr(0, 1).toUpperCase() + ".png";
			document.getElementById("bStraight" + i).onclick = function(){setDial(this.id)};
		} else {
			document.getElementById("bStraight" + i).onclick = null;
		};
		document.getElementById("mKoiogran" + i).style.opacity = (range[i][3] == 0) ? 0 : 1;
		if (range[i][3] != 0) {
			document.getElementById("aKoiogran" + i).src = "images/koiogran" + range[i][3].substr(0, 1).toUpperCase() + ".png";
			document.getElementById("bKoiogran" + i).onclick = function(){setDial(this.id)};
		} else {
			document.getElementById("bKoiogran" + i).onclick = null;
		};
		if (range[i][4][0] != 0) {
			document.getElementById("mSegnors" + i + "l").hidden = false;
			document.getElementById("mSegnors" + i + "r").hidden = false;
			document.getElementById("aSegnors" + i + "l").src = "images/segnors" + range[i][4][0].substr(0, 1).toUpperCase() + ".png";
			document.getElementById("aSegnors" + i + "r").src = "images/segnors" + range[i][4][1].substr(0, 1).toUpperCase() + ".png";
			document.getElementById("bSegnors" + i + "l").onclick = function(){setDial(this.id)};
			document.getElementById("bSegnors" + i + "r").onclick = function(){setDial(this.id)};
		} else {
			document.getElementById("mSegnors" + i + "l").hidden = true;
			document.getElementById("mSegnors" + i + "r").hidden = true;
			document.getElementById("bSegnors" + i + "l").onclick = null;
			document.getElementById("bSegnors" + i + "r").onclick = null;
		};
		if (range[i][5][0] != 0) {
			document.getElementById("mTallon" + i + "l").hidden = false;
			document.getElementById("mTallon" + i + "r").hidden = false;
			document.getElementById("aTallon" + i + "l").src = "images/tallon" + range[i][5][0].substr(0, 1).toUpperCase() + ".png";
			document.getElementById("aTallon" + i + "r").src = "images/tallon" + range[i][5][1].substr(0, 1).toUpperCase() + ".png";
			document.getElementById("bTallon" + i + "l").onclick = function(){setDial(this.id)};
			document.getElementById("bTallon" + i + "r").onclick = function(){setDial(this.id)};
		} else {
			document.getElementById("mTallon" + i + "l").hidden = true;
			document.getElementById("mTallon" + i + "r").hidden = true;
			document.getElementById("bTallon" + i + "l").onclick = null;
			document.getElementById("bTallon" + i + "r").onclick = null;
		};
	};
	var kturns = range[1][3] + range[2][3] + range[3][3] + range[4][3] + range[5][3];
	for (var i = 1; i < 6; i++) {
		document.getElementById("mKoiogran" + i).hidden = (kturns == 0) ? true : false;
	};
	document.getElementById("mRow5").style.opacity = (range[5].join("") == "000000") ? 0.5 : 1;
};

function reset () {
	for (var i =  1; i < ctx.length; i++) {
		ctx[i].setTransform(1, 0, 0, 1, 0, 0);
		ctx[i].clearRect(0, 0, 800, 600);
		ctx[i].translate(800 / 2, 600 * 2 / 3);
	};
};

function setDecloak (pattern, index, index2) {
	stepOverride = true;
	var overlays = document.getElementsByClassName("decloak");
	var all = (decloak != undefined && ship.decloak.length == decloak.length);
	if (pattern == "all") {
		for (var i = 0; i < overlays.length; i++) {
			document.getElementsByClassName("decloak")[i].style.opacity = (all) ? 0.7 : 0;
			decloak = (all) ? [] : ship.decloak.slice(0);
		};
	} else {
		var on = decloak.indexOf(ship.decloak[index]);
		id = "decloak" + index + pattern;
		document.getElementById(id).style.opacity = (on == -1) ? 0 : 0.7;
		if (on == -1) {
			decloak.push(ship.decloak[index]);
		} else {
			decloak.splice(on, 1);
		};
		if (index2 != undefined) {
			on = decloak.indexOf(ship.decloak[index2]);
			if (on == -1) {
				decloak.push(ship.decloak[index2]);
			} else {
				decloak.splice(on, 1);
			};
		};
	};
	saveState();
};

function setDial (buttonID) {
	stepOverride = true;
	var overlays = document.getElementsByClassName("maneuver");
	var all = (dial != undefined && ship.dial.length == dial.length);
	if (buttonID == "all") {
		for (var i = 0; i < overlays.length; i++) {
			document.getElementsByClassName("maneuver")[i].style.opacity = (all) ? 0.7 : 0;
			dial = (all) ? [] : ship.dial.slice(0);
		};
	} else {
		var direction = buttonID.substr(-1);
		if (isFinite(direction)) {
			var movement = buttonID.substr(1, 8).toLowerCase();
			var distance = direction;
			var direction = undefined;
		} else {
			var movement = buttonID.substr(1, buttonID.length - 3).toLowerCase();
			var distance = buttonID.substr(-2, 1);
			direction = (direction == "l") ? -1 : 1;
		};
		var index;
		for (var i = 0; i < ship.dial.length; i++) {
			if (ship.dial[i][0] == movement && ship.dial[i][2] == distance && (direction == undefined || ship.dial[i][3] == direction)) {
				index = i;
			};
		};
		var on = dial.indexOf(ship.dial[index]);
		document.getElementById(buttonID).style.opacity = (on == -1) ? 0 : 0.7;
		if (on == -1) {
			dial.push(ship.dial[index]);
		} else {
			dial.splice(on, 1);
		};
	};
	saveState();
};

function loop () {
	var target = document.getElementById("option_loop");
	var state = target.style.opacity;
	if (state == 0) {
		target.style.opacity = 0.5;
	} else {
		target.style.opacity = 0;
		for (var i = 0; i < timer.length; i++) {
			timer[i] = 0;
		};
		barrel_roll_timer = [0, 0];
		boost_timer = [0, 0];
		slam_timer = [0, 0];
		bbPTL_timer = [0, 0];
	};
	saveState();
};

function switchFilter (type) {
	document.getElementById("boostFilters").hidden = (type == "boost") ? false : true;
	document.getElementById("rollFiltersA").hidden = (type == "roll") ? false : true;
	document.getElementById("rollFiltersB").hidden = (type == "roll") ? false : true;
};

function setFilter (type, index) {
	stepOverride = true;
	var buttonID = "button_" + type + "Filter" + index;
	var target = document.getElementById(buttonID);
	var state = target.style.opacity;
	if (type == "roll") {
		fRoll[index] = (target.style.opacity > 0) ? false : true;
	} else {
		fBoost[index] = (target.style.opacity > 0) ? false : true;
	};
	target.style.opacity = (target.style.opacity > 0) ? 0 : 0.5;
};

function barrel_roll () {
	stepOverride = true;
	var boost = (document.getElementById("button_boost").style.opacity > 0) ? false : true;
	var target = document.getElementById("button_barrel");
	var state = target.style.opacity;
	if (state == 0) {
		target.style.opacity = 0.5;
		barrel_roll_timer = [timer[4], timer[5]];
		timer[4] = 0;
		timer[5] = 0;
		bbPTL();
		if (!boost) {
			advSensors();
		};
	} else {
		target.style.opacity = 0;
		timer[4] = barrel_roll_timer[0];
		timer[5] = barrel_roll_timer[1];
		if (boost) {
			document.getElementById("button_bbPTL").style.opacity = 0.5;
		};
		if (!boost) {
			document.getElementById("button_sensors").style.opacity = 0.5;
		};
		fRoll = [false, false, false, false];
		document.getElementById("button_rollFilter0").style.opacity = 0;
		document.getElementById("button_rollFilter1").style.opacity = 0;
		document.getElementById("button_rollFilter2").style.opacity = 0;
		document.getElementById("button_rollFilter3").style.opacity = 0;
	};
	saveState();
};

function boost () {
	stepOverride = true;
	var barrel_roll = (document.getElementById("button_barrel").style.opacity > 0) ? false : true;
	var target = document.getElementById("button_boost");
	var state = target.style.opacity;
	if (state == 0) {
		target.style.opacity = 0.5;
		boost_timer = [timer[6], timer[7]];
		timer[6] = 0;
		timer[7] = 0;
		bbPTL();
		if (!barrel_roll) {
			advSensors();
		};
	} else {
		target.style.opacity = 0;
		timer[6] = boost_timer[0];
		timer[7] = boost_timer[1];
		if (barrel_roll) {
			document.getElementById("button_bbPTL").style.opacity = 0.5;
		};
		if (!barrel_roll) {
			document.getElementById("button_sensors").style.opacity = 0.5;
		};
		fBoost = [false, false, false];
		document.getElementById("button_boostFilter0").style.opacity = 0;
		document.getElementById("button_boostFilter1").style.opacity = 0;
		document.getElementById("button_boostFilter2").style.opacity = 0;
	};
	saveState();
};

function slam () {
	stepOverride = true;
	var sensors = (document.getElementById("button_sensors").style.opacity > 0) ? false : true;
	var bbPTL = (document.getElementById("button_bbPTL").style.opacity > 0) ? false : true;
	var target = document.getElementById("button_slam");
	var state = target.style.opacity;
	if (ship.actions.indexOf("slam") == -1) {
		target.style.opacity = 1;
	} else {
		timer_reset(true);
		if (state == 0) {
			target.style.opacity = 0.5;
			slam_timer = [timer[10], timer[11]];
			timer[10] = 0;
			timer[11] = 0;
		} else {
			if (sensors) {
				document.getElementById("button_sensors").style.opacity = 0.5;
			};
			if (bbPTL) {
				document.getElementById("button_bbPTL").style.opacity = 0.5;
			};
			target.style.opacity = 0;
			timer[10] = slam_timer[0];
			timer[11] = slam_timer[1];
		};
	};
	saveState();
};

function bbPTL () {
	stepOverride = true;
	var barrel_roll = (document.getElementById("button_barrel").style.opacity > 0) ? false : true;
	var boost = (document.getElementById("button_boost").style.opacity > 0) ? false : true;
	var slam = (document.getElementById("button_slam").style.opacity > 0) ? false : true;
	var target = document.getElementById("button_bbPTL");
	var state = target.style.opacity;
	if (state > 0 && barrel_roll && boost) {
		if (slam) {
			document.getElementById("button_slam").style.opacity = 0.5;
		};
		target.style.opacity = 0;
		timer[8] = bbPTL_timer[0];
		timer[9] = bbPTL_timer[1];
	} else {
		target.style.opacity = (!barrel_roll || !boost) ? 1 : 0.5;
		if (timer[8] > 0) {
			bbPTL_timer = [timer[8], timer[9]];
		};
		timer[8] = 0;
		timer[9] = 0;
	};
	saveState();
};

function advSensors () {
	stepOverride = true;
	var barrel_roll = (document.getElementById("button_barrel").style.opacity > 0) ? false : true;
	var boost = (document.getElementById("button_boost").style.opacity > 0) ? false : true;
	var slam = (document.getElementById("button_slam").style.opacity > 0) ? false : true;
	var target = document.getElementById("button_sensors");
	var state = target.style.opacity;
	if (state == 0.5 && (barrel_roll || boost)) {
		if (slam) {
			document.getElementById("button_slam").style.opacity = 0.5;
		};
		target.style.opacity = 0;
		timer_reset(true);
	} else {
		target.style.opacity = (!barrel_roll && !boost) ? 1 : 0.5;
		if (state == 0) {
			timer_reset(true);
		};
	};
	saveState();
};

function starfield () {
	var state = document.getElementById("option_starfield").style.opacity;
	if (state > 0) {
		ctx[0].fillStyle = "white";
		for (var i = 0; i < 42; i++) {
			var x = 10 + Math.random() * 780;
			var y = 10 + Math.random() * 580;
			var r = Math.random() * 5;
			for (var size = r; size > 0; size--) {
				ctx[0].beginPath();
				ctx[0].moveTo(x, y);
				ctx[0].arc (x, y, size, 0, 2 * pi);
				ctx[0].globalAlpha = 1/size;
				ctx[0].fill();
			};
		};
		document.getElementById("option_starfield").style.opacity = 0;
	} else {
		ctx[0].clearRect(0, 0, 800, 600);
		document.getElementById("option_starfield").style.opacity = 0.5;
	};
	saveState();
};

function gridfield () {
	gctx.clearRect(0, 0, 800, 600);
	var z = Number(gridlayer.style.zIndex);
	if (z < 8) {
		gridlayer.style.zIndex = z + 3;
		gctx.globalAlpha = 0.1;
		gctx.beginPath();
		gctx.fillStyle = "#FF3300";
		gctx.fillRect(0, 0, 800, 600);
		gctx.globalAlpha = 1;
		gctx.strokeStyle = "#FF8800";
		gctx.lineWidth = 1;
		for (var i = 20; i < 800; i += 40) {
			gctx.beginPath();
			gctx.moveTo(i, 0);
			gctx.lineTo(i, 600);
			gctx.stroke();
		};
		for (var i = 40; i < 600; i += 40) {
			gctx.beginPath();
			gctx.moveTo(0, i);
			gctx.lineTo(800, i);
			gctx.stroke();
		};
		switch (Number(gridlayer.style.zIndex)) {
			case 2:
				document.getElementById("grid_level").innerHTML = "1";
				break;
			case 5:
				document.getElementById("grid_level").innerHTML = "2";
				break;
			case 8:
				document.getElementById("grid_level").innerHTML = "3";
				break;
		};
		document.getElementById("option_grid").style.opacity = 0;
	} else {
		gridlayer.style.zIndex = -1;
		document.getElementById("grid_level").innerHTML = "";
		document.getElementById("option_grid").style.opacity = 0.5;
	};
	saveState();
};

function fire () {
	stepOverride = true;
	var arcrange = document.getElementById("fire_range").innerHTML;
	if (arcrange == "") {
		arcrange = 0;
	};
	arcrange++;
	if (arcrange > 3) {
		document.getElementById("option_fire").style.opacity = 0.5;
		document.getElementById("fire_range").innerHTML = "";
	} else {
		document.getElementById("option_fire").style.opacity = 0;
		document.getElementById("fire_range").innerHTML = arcrange;
	};
	saveState();
};

function transparent () {
	var state = document.getElementById("option_transparent").style.opacity;
	stepOverride = true;
	if (state > 0) {
		document.getElementById("option_transparent").style.opacity = 0;
	} else {
		document.getElementById("option_transparent").style.opacity = 0.5;
	};
	saveState();
};

function drawFiringArcs (x, y) {
	var arcrange = document.getElementById("fire_range").innerHTML;
	if (arcrange == "") {
		arcrange = 0;
	};
	var color = (ship.faction == "empire") ? "#70C045" : ((ship.faction == "alliance") ? "#EC2424" : "#DCA824");
	var offset = (ship.base == smallbase) ? 16 : 35;
	ctx[2].save();
	ctx[2].lineWidth = 1;
	ctx[2].fillStyle = color;
	ctx[2].strokeStyle = color;
	if (ship.arc == "turret") {
		ctx[2].globalAlpha = 0.1;
		ctx[2].beginPath();
		ctx[2].moveTo(x - ship.base / 2, y);
		ctx[2].arc(x - ship.base / 2, y, 100 * arcrange, pi, 1.5 * pi, false);
		ctx[2].lineTo(x + ship.base / 2, y - 100 * arcrange);
		ctx[2].arc(x + ship.base / 2, y, 100 * arcrange, 1.5 * pi, 0, false);
		ctx[2].lineTo(x + ship.base / 2 + 100 * arcrange, y + ship.base);
		ctx[2].arc(x + ship.base / 2, y + ship.base, 100 * arcrange, 0, 0.5 * pi, false);
		ctx[2].lineTo(x - ship.base / 2, y + ship.base + 100 * arcrange);
		ctx[2].arc(x - ship.base / 2, y + ship.base, 100 * arcrange, 0.5 * pi, pi, false);
		ctx[2].lineTo(x - ship.base / 2 - 100 * arcrange, y);
		ctx[2].lineTo(x - ship.base / 2, y);
		ctx[2].lineTo(x - ship.base / 2, y + ship.base);
		ctx[2].lineTo(x + ship.base / 2, y + ship.base);
		ctx[2].lineTo(x + ship.base / 2, y);
		ctx[2].fill();
		ctx[2].beginPath();
		ctx[2].arc(x + ship.base / 2, y, 100 * arcrange, (1.5 + 2/9) * pi, 0, false);
		ctx[2].lineTo(x + ship.base / 2 + 100 * arcrange, y + ship.base);
		ctx[2].arc(x + ship.base / 2, y + ship.base, 100 * arcrange, 0, 0.5 * pi, false);
		ctx[2].lineTo(x - ship.base / 2, y + ship.base + 100 * arcrange);
		ctx[2].arc(x - ship.base / 2, y + ship.base, 100 * arcrange, 0.5 * pi, pi, false);
		ctx[2].lineTo(x - ship.base / 2 - 100 * arcrange, y);
		ctx[2].arc(x - ship.base / 2, y, 100 * arcrange, pi, (1.5 - 2/9) * pi, false);
		ctx[2].globalAlpha = 0.3;
		ctx[2].stroke();
	};
	if (ship.arc == "180") {
		ctx[2].globalAlpha = 0.1;
		ctx[2].beginPath();
		ctx[2].moveTo(x - ship.base / 2, y);
		ctx[2].lineTo(x - ship.base / 2, y + ship.base / 2);
		ctx[2].lineTo(x - ship.base / 2 - 100 * arcrange, y + ship.base / 2);
		ctx[2].lineTo(x - ship.base / 2 - 100 * arcrange, y);
		ctx[2].arc(x - ship.base / 2, y, 100 * arcrange, pi, 1.5 * pi, false);
		ctx[2].lineTo(x + ship.base / 2, y - 100 * arcrange);
		ctx[2].arc(x + ship.base / 2, y, 100 * arcrange, 1.5 * pi, 0, false);
		ctx[2].lineTo(x + ship.base / 2 + 100 * arcrange, y + ship.base / 2);
		ctx[2].lineTo(x + ship.base / 2, y + ship.base / 2);
		ctx[2].lineTo(x + ship.base / 2, y);
		ctx[2].fill();
		ctx[2].beginPath();
		ctx[2].moveTo(x - ship.base / 2, y + ship.base / 2);
		ctx[2].lineTo(x - ship.base / 2 - 100 * arcrange, y + ship.base / 2);
		ctx[2].lineTo(x - ship.base / 2 - 100 * arcrange, y);
		ctx[2].arc(x - ship.base / 2, y, 100 * arcrange, pi, (1.5 - 2/9) * pi, false);
		ctx[2].globalAlpha = 0.9;
		ctx[2].setLineDash([4]);
		ctx[2].stroke();
		ctx[2].beginPath();
		ctx[2].moveTo(x + ship.base / 2, y + ship.base / 2);
		ctx[2].lineTo(x + ship.base / 2 + 100 * arcrange, y + ship.base / 2);
		ctx[2].lineTo(x + ship.base / 2 + 100 * arcrange, y);
		ctx[2].arc(x + ship.base / 2, y, 100 * arcrange, 0, (1.5 + 2/9) * pi, true);
		ctx[2].stroke();
		ctx[2].setLineDash([]);
	};
	ctx[2].globalAlpha = 0.1;
	ctx[2].beginPath();
	ctx[2].moveTo(x - offset, y);
	ctx[2].arc(x - ship.base / 2, y, 100 * arcrange, (1.5 - 2/9) * pi, 1.5 * pi, false);
	ctx[2].lineTo(x + offset, y - 100 * arcrange);
	ctx[2].arc(x + ship.base / 2, y, 100 * arcrange, 1.5 * pi, (1.5 + 2/9) * pi, false);
	ctx[2].lineTo(x + offset, y);
	ctx[2].fill();
	ctx[2].globalAlpha = 0.9;
	ctx[2].stroke();
	if (ship.arc == "rear") {
		ctx[2].globalAlpha = 0.1;
		ctx[2].beginPath();
		ctx[2].moveTo(x - offset, y + ship.base);
		ctx[2].arc(x - ship.base / 2, y + ship.base, 100 * arcrange, (0.5 + 2/9) * pi, 0.5 * pi, true);
		ctx[2].lineTo(x + offset, y + ship.base + 100 * arcrange);
		ctx[2].arc(x + ship.base / 2, y + ship.base, 100 * arcrange, 0.5 * pi, (0.5 - 2/9) * pi, true);
		ctx[2].lineTo(x + offset, y + ship.base);
		ctx[2].fill();
		ctx[2].globalAlpha = 0.9;
		ctx[2].setLineDash([4]);
		ctx[2].stroke();
	};
	ctx[2].restore();
};

function step () {
	var looping = (document.getElementById("option_loop").style.opacity > 0) ? false : true;
	var cloaking = (decloak.length > 0) ? true : false;
	var barrel_rolls = (document.getElementById("button_barrel").style.opacity > 0) ? false : true;
	var boosts = (document.getElementById("button_boost").style.opacity > 0) ? false : true;
	var slam = (document.getElementById("button_slam").style.opacity > 0) ? false : true;
	var bbPTL = (document.getElementById("button_bbPTL").style.opacity > 0) ? false : true;
	var sensors = (document.getElementById("button_sensors").style.opacity > 0) ? false : true;
	if (stepOverride || (looping && !queued) || (cloaking && timer[1] < 100) || timer[3] < 100 || (barrel_rolls && timer[5] < 100) || (boosts && timer[7] < 100) || (bbPTL && timer[9] < 100) || (slam && timer[11] < 100)) {
		stepOverride = false;
		reset();
// decloak separation timer
		if (cloaking && timer[0] < 100) {
			timer[0] += 5;
		};
// decloak movement timer
		if (cloaking && timer[0] >= 100 && timer[1] < 100) {
			timer[1] += 2
		};
// maneuver separation timer
		if ((!cloaking || timer[1] >= 100) && timer[2] < 100 && (!sensors || (sensors && (barrel_rolls || boosts) && (timer[9] >= 100 || (!bbPTL && (timer[5] >= 100 || !barrel_rolls) && (timer[7] >= 100 || !boosts)))))) {
			timer[2] += 5;
		};
// maneuver movement timer
		if (timer[2] >= 100 && timer[3] < 100) {
			timer[3] += 2
		};
// action barrel roll separation timer
		if (barrel_rolls && ((sensors && (!cloaking || timer[1] >= 100)) || timer[3] >= 100) && timer[4] < 100) {
			timer[4] += 5
		};
// action barrel roll movement timer
		if (barrel_rolls && timer[4] >= 100 && timer[5] < 100) {
			timer[5] += 2
		};
// action boost separation timer
		if (boosts && ((sensors && (!cloaking || timer[1] >= 100)) || timer[3] >= 100) && timer[6] < 100) {
			timer[6] += 5
		};
// action boost movement timer
		if (boosts && timer[6] >= 100 && timer[7] < 100) {
			timer[7] += 2
		};
// PTL barrel roll/boost separation timer
		if (bbPTL && barrel_rolls && boosts && timer[5] >= 100 && timer[7] >= 100 && timer[8] < 100) {
			timer[8] += 5
		};
// PTL barrel roll/boost movement timer
		if (bbPTL && barrel_rolls && boosts && timer[8] >= 100 && timer[9] < 100) {
			timer[9] += 2
		};
// SLAM separation timer
		if (slam && timer[3] >= 100 && timer[10] < 100) {
			timer[10] += 5
		};
// SLAM movement timer
		if (slam && timer[10] >= 100 && timer[11] < 100) {
			timer[11] += 2
		};
		if (decloak.length > 0) {
			for (var i = 0; i < decloak.length; i++) {
				animate(decloak[i], 0);
			};
		} else {
			if (sensors) {
				if (barrel_rolls) {
					animateBarrelRolls("purple", 4);
				};
				if (boosts) {
					animateBoosts("purple", 6);
				};
			} else {
				for (var i = 0; i < dial.length; i++) {
					animate(dial[i], 2);
				};
			};
		};
		if (looping && timer[3] >= 100 && !queued && (!barrel_rolls || timer[5] >= 100) && (!boosts || timer[7] >= 100) && (!bbPTL || timer[9] >= 100) && (!slam || timer[11] >= 100)) {
			setTimeout(function(){timer_reset();}, 3000);
			queued = true;
		};
		drawShip(3, 0, 0, 0.99 - timer[0] / 400 - timer[1] / 400);
	};
};

function blarg (x, y, alpha) {
	ctx[2].save;
	var beam = 16;
	ctx[2].lineWidth = beam;
	ctx[2].globalAlpha = 0.5 * alpha;
	var sequence = ["#FF0000", "#FF7F00", "#FFFF00", "#00FF00", "#0000FF", "#7F00FF", "#FF00FF"];
	for (var i = 0; i < sequence.length; i++) {
		ctx[2].beginPath();
		ctx[2].moveTo(3 * beam - beam * i + x, -3.5 * beam + y);
		ctx[2].lineTo(3 * beam - beam * i + x, -3.5 * beam - 800 + y);
		ctx[2].strokeStyle = sequence[i];
		ctx[2].stroke();
		ctx[2].beginPath();
		ctx[2].fillStyle = sequence[i];
		ctx[2].moveTo(x, y);
		ctx[2].quadraticCurveTo((2.5 - i) * beam + x, y, (2.5 - i) * beam + x, -3.5 * beam + y);
		ctx[2].lineTo((3.5 - i) * beam + x, -3.5 * beam + y);
		ctx[2].quadraticCurveTo((3.5 - i) * beam + x, y, x, y);
		ctx[2].fill();
	};
	ctx[2].restore;
};

function timer_reset (timerOverride) {
	queued = false;
	var looping = (document.getElementById("option_loop").style.opacity > 0) ? false : true;
	var barrel_rolls = (document.getElementById("button_barrel").style.opacity > 0) ? false : true;
	var boosts = (document.getElementById("button_boost").style.opacity > 0) ? false : true;
	var slam = (document.getElementById("button_slam").style.opacity > 0) ? false : true;
	var bbPTL = (document.getElementById("button_bbPTL").style.opacity > 0) ? false : true;
	if (timerOverride || ((looping && timer[3] >= 100) && (!barrel_rolls || timer[5] >= 100) && (!boosts || timer[7] >= 100) && (!bbPTL || timer[9] >= 100) && (!slam || timer[11] >= 100))) {	
		for (var i = 0; i < timer.length; i++) {
			timer[i] = 0;
		};
		barrel_roll_timer = [0, 0];
		boost_timer = [0, 0];
		slam_timer = [0, 0];
		bbPTL_timer = [0, 0];
	};
};

function drawShip (z, x, y, alpha) {
	var arcrange = document.getElementById("fire_range").innerHTML;
	var clearbase = document.getElementById("option_transparent").style.opacity;
	ctx[z].globalAlpha = alpha;
	if (clearbase == 0) {
		ctx[z].strokeStyle = "white";
		ctx[z].beginPath();
		ctx[z].rect(x - ship.base / 2, y, ship.base, ship.base);
		ctx[z].stroke();
		ctx[z].beginPath();
		ctx[z].moveTo(x - ship.base / 5, y + ship.base / 5);
		ctx[z].lineTo(x, y + ship.base / 10);
		ctx[z].lineTo(x + ship.base / 5, y + ship.base / 5);
		ctx[z].stroke();
	} else {
		ctx[z].drawImage(ship.img, x - ship.base / 2 - ship.offset, y - ship.protrusions, ship.width, ship.height);
	};
	if (wharrgarbl == 1) {
		blarg(x, y, alpha);
	} else {
		if (arcrange != "" && timer[3] == 100 && alpha == 1) {
			drawFiringArcs(x, y);
		};
	};
};

function drawX () {
	ctx[3].globalAlpha = 1;
	ctx[3].lineWidth = 1;
	ctx[3].strokeStyle = "red";
	ctx[3].beginPath();
	ctx[3].moveTo(-3, 0);
	ctx[3].lineTo(3, 0);
	ctx[3].stroke();
	ctx[3].beginPath();
	ctx[3].moveTo(0, -6);
	ctx[3].lineTo(0, 3);
	ctx[3].stroke();
};

function oBank (z, distance, direction) {
	var radius = rBank[distance];
	ctx[z].translate(direction * radius, 0);
	ctx[z].rotate(direction * 0.25 * pi);
	ctx[z].translate(direction * -radius, -ship.base);
};

function oBankroll (z, distance, direction, start, end, bank) {
	var radius = rBank[distance];
	ctx[z].translate(direction * ship.base / 2, ship.base / 2 - start * ship.base / 4);
	ctx[z].rotate(direction * 0.5 * pi);
	ctx[z].translate(bank * radius, 0);
	ctx[z].rotate(bank * 0.25 * pi);
	ctx[z].translate(bank * -radius, 0);
	ctx[z].rotate(direction * -0.5 * pi);
	ctx[z].translate(direction * ship.base / 2, -ship.base / 2 + end * -ship.base / 4);
};

function oRoll (z, distance, direction, start) {
	ctx[z].translate(direction * ship.base / 2, ship.base / 2 - start * ship.base / 4);
	ctx[z].translate(direction * distance * (20 + (largebase - ship.base) / 2), 0);
	ctx[z].translate(direction * ship.base / 2, -start * ship.base / 4 - ship.base / 2);
};

function oStraight (z, distance) {
	ctx[z].translate(0, distance * -smallbase - ship.base);
};

function oTurn (z, distance, direction) {
	var radius = rTurn[distance];
	ctx[z].translate(direction * radius, 0);
	ctx[z].rotate(direction * 0.5 * pi);
	ctx[z].translate(direction * -radius, -ship.base);
};

function oRotate (z, arc) {
	ctx[z].translate(0, ship.base / 2);
	ctx[z].rotate(arc * pi);
	ctx[z].translate(0, -ship.base / 2);
};

function animate (flightplan, phase) {
	switch (flightplan[0]) {
		case "bank":
			animateBank(flightplan, phase);
			break;
		case "bankroll":
			animateBankroll(flightplan, phase);
			break;
		case "koiogran":
			animateKoiogran(flightplan, phase);
			break;
		case "roll":
			animateRoll(flightplan, phase);
			break;
		case "segnors":
			animateSegnors(flightplan, phase);
			break;
		case "straight":
			animateStraight(flightplan, phase);
			break;
		case "tallon":
			animateTallon(flightplan, phase);
			break;
		case "turn":
			animateTurn(flightplan, phase);
			break;
	};
};

function animateBarrelRolls (color, phase) {
	if (!fRoll[0]) {
		animateRoll(["roll", color, 1, -1, 1], phase);
	};
	if (!fRoll[2]) {
		animateRoll(["roll", color, 1, -1, -1], phase);
	};
	if (!fRoll[1]) {
		animateRoll(["roll", color, 1, 1, 1], phase);
	};
	if (!fRoll[3]) {
		animateRoll(["roll", color, 1, 1, -1], phase);
	};
};

function animateBoosts (color, phase) {
	if (!fBoost[0]) {
		animateBank(["bank", color, 1, -1], phase);
	};
	if (!fBoost[1]) {
		animateStraight(["straight", color, 1], phase);
	};
	if (!fBoost[2]) {
		animateBank(["bank", color, 1, 1], phase);
	};
};

function animateSlams (distance, phase) {
	var slam = (document.getElementById("button_slam").style.opacity > 0) ? false : true;
	if (slam) {
		for (var i = 0; i < ship.dial.length; i++) {
			if (ship.dial[i][2] == distance) {
				animate(ship.dial[i], phase);
			};
		};
	};
};

function animateBank (flightplan, phase) {
	var distance = flightplan[2];
	var direction = flightplan[3];
	var radius = rBank[distance];
	var cloaking = (decloak.length > 0) ? true : false;
	var bbPTL = (document.getElementById("button_bbPTL").style.opacity > 0) ? false : true;
	var sensors = (document.getElementById("button_sensors").style.opacity > 0) ? false : true;
	for (var j = 1; j < ctx.length; j++) {
		ctx[j].save();
		ctx[j].translate(direction * radius, 0);
		ctx[j].rotate(timer[phase + 1] * direction * 0.0025 * pi);
	};
	ctx[1].globalAlpha = (1 - 0.5 * ((phase == 0) ? (timer[3] / 100) : 0)) * 0.5 * timer[phase + 1] / 100;
	ctx[1].beginPath();
	ctx[1].arc (0, 0, radius, (0.5 + direction * 0.5) * pi, (0.5 + direction * 0.5  + direction * timer[phase + 1] * -0.0025) * pi, (direction == 1) ? true : false);
	ctx[1].strokeStyle = flightplan[1];
	ctx[1].lineWidth = smallbase / 2;
	ctx[1].stroke();
	switch (phase) {
		case 2:
			var phasemod = (sensors) ? 0 : (Math.max(timer[5], timer[7]) / 100);
			break;
		case 6:
			var phasemod = (sensors && !bbPTL) ? (timer[3] / 100) : (timer[9] / 100);
			break;
		case 8:
			var phasemod = (sensors) ? (timer[3] / 100) : 0;
			break;
		default:
			var phasemod = 0;
			break;
	};
	drawShip(3, direction * -radius, timer[phase] / 100 * -ship.base, (1 - 0.7 * ((phase == 0) ? (timer[3] / 100) : 0)) * (0.1 * timer[phase] / 100 + 0.9 * timer[phase + 1] / 100) * (1 - (1 - remnant) * phasemod));
	for (var j = 1; j < ctx.length; j++) {
		ctx[j].restore();
	};
	if ((!sensors && phase == 0 && timer[1] >= 100) || (sensors && timer[phase + 1] >= 100 && ((phase == 6 && !bbPTL) || phase == 8))) {
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].save();
			oBank(j, distance, direction);
		};
		for (var j = dial.length; j > 0; j--) {
			animate(dial[j-1], 2);
		};
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].restore();
		};
	};
	if ((sensors && phase == 0 && timer[1] >= 100) || (!sensors && phase == 2 && timer[3] >= 100)) {
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].save();
			oBank(j, distance, direction);
		};
		animateBarrelRolls("purple", 4);
		animateBoosts("purple", 6);
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].restore();
		};
	};
	if (bbPTL && phase == 6 && timer[7] >= 100) {
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].save();
			oBank(j, distance, direction);
		};
		animateRoll(["roll", "red", 1, -1, 1], 8);
		animateRoll(["roll", "red", 1, -1, -1], 8);
		animateRoll(["roll", "red", 1, 1, 1], 8);
		animateRoll(["roll", "red", 1, 1, -1], 8);
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].restore();
		};
	};
	if (!sensors && phase == 2 && timer[3] >= 100) {
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].save();
			oBank(j, distance, direction);
		};
		animateSlams(distance, 10);
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].restore();
		};
	};
};

function animateBankroll (flightplan, phase) {
	var distance = flightplan[2];
	var direction = flightplan[3];
	var start = flightplan[4];
	var bank = flightplan[5];
	var radius = rBank[distance];
	var cloaking = (decloak.length > 0) ? true : false;
	var bbPTL = (document.getElementById("button_bbPTL").style.opacity > 0) ? false : true;
	var sensors = (document.getElementById("button_sensors").style.opacity > 0) ? false : true;
	for (var j = 1; j < ctx.length; j++) {
		ctx[j].save();
		ctx[j].translate(direction * ship.base / 2, ship.base / 2 - start * ship.base / 4);
		ctx[j].rotate(direction * 0.5 * pi);
		ctx[j].translate(bank * radius, 0);
		ctx[j].rotate(timer[phase + 1] * bank * 0.0025 * pi);
	};
	ctx[1].globalAlpha = (1 - 0.5 * ((phase == 0) ? (timer[3] / 100) : 0)) * 0.5 * timer[phase + 1] / 100;
	ctx[1].beginPath();
	ctx[1].arc (0, 0, radius, (0.5 + bank * 0.5) * pi, (0.5 + bank * 0.5  + bank * timer[phase + 1] * -0.0025) * pi, (bank == 1) ? true : false);
	ctx[1].strokeStyle = flightplan[1];
	ctx[1].lineWidth = smallbase / 2;
	ctx[1].stroke();
	var phasemod = 0;
	for (var j = 1; j < ctx.length; j++) {
		ctx[j].rotate(direction * -0.5 * pi);
		ctx[j].translate(direction * ship.base / 2, -ship.base * 3 / 4);
	};
	drawShip(3, (1 - timer[phase] / 100) * direction * -ship.base, (1 - timer[phase] / 100 * (0.5 + 0.5 * start)) * ship.base / 2 + (-0.5 + 0.5 * start) * ship.base / 2 - direction * bank * radius, (1 - 0.7 * ((phase == 0) ? (timer[3] / 100) : 0)) * (0.1 * timer[phase] / 100 + 0.9 * timer[phase + 1] / 100) * (1 - (1 - remnant) * phasemod));
	drawShip(3, (1 - timer[phase] / 100) * direction * -ship.base, (1 + timer[phase] / 100 * (0.5 - 0.5 * start)) * ship.base / 2 + (-0.5 + 0.5 * start) * ship.base / 2 - direction * bank * radius, (1 - 0.7 * ((phase == 0) ? (timer[3] / 100) : 0)) * (0.1 * timer[phase] / 100 + 0.9 * timer[phase + 1] / 100) * (1 - (1 - remnant) * phasemod));
	for (var j = 1; j < ctx.length; j++) {
		ctx[j].restore();
	};
	if (!sensors && phase == 0 && timer[1] >= 100) {
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].save();
			oBankroll(j, distance, direction, start, 1, bank);
		};
		for (var j = dial.length; j > 0; j--) {
			animate(dial[j-1], 2);
		};
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].restore();
			ctx[j].save();
			oBankroll(j, distance, direction, start, -1, bank);
		};
		for (var j = dial.length; j > 0; j--) {
			animate(dial[j-1], 2);
		};
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].restore();
		};
	};
	if (sensors && phase == 0 && timer[1] >= 100) {
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].save();
			oBankroll(j, distance, direction, start, 1, bank);
		};
		animateBarrelRolls("purple", 4);
		animateBoosts("purple", 6);
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].restore();
			ctx[j].save();
			oBankroll(j, distance, direction, start, -1, bank);
		};
		animateBarrelRolls("purple", 4);
		animateBoosts("purple", 6);
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].restore();
		};
	};
};

function animateRoll (flightplan, phase) {
	var distance = flightplan[2];
	var direction = flightplan[3];
	var start = flightplan[4];
	var cloaking = (decloak.length > 0) ? true : false;
	var bbPTL = (document.getElementById("button_bbPTL").style.opacity > 0) ? false : true;
	var sensors = (document.getElementById("button_sensors").style.opacity > 0) ? false : true;
	for (var j = 1; j < ctx.length; j++) {
		ctx[j].save();
		ctx[j].translate(direction * ship.base / 2, ship.base / 2 - start * ship.base / 4);
		ctx[j].rotate(direction * 0.5 * pi);
	};
	ctx[1].globalAlpha = (1 - 0.5 * ((phase == 0) ? (timer[3] / 100) : 0)) * 0.5 * timer[phase + 1] / 100;
	ctx[1].beginPath();
	ctx[1].moveTo(0, 0);
	ctx[1].lineTo(0, timer[phase + 1] / 100 * distance * -(20 + (largebase - ship.base) / 2));
	ctx[1].strokeStyle = flightplan[1];
	ctx[1].lineWidth = ship.base / 2;
	ctx[1].stroke();
	switch (phase) {
		case 4:
			var phasemod = (sensors && !bbPTL) ? (timer[3] / 100) : (timer[9] / 100);
			break;
		case 8:
			var phasemod = (sensors) ? (timer[3] / 100) : 0;
			break;
		default:
			var phasemod = 0;
			break;
	};
	for (var j = 1; j < ctx.length; j++) {
		ctx[j].rotate(direction * -0.5 * pi);
		ctx[j].translate(direction * ship.base / 2, -ship.base / 2);
	};
	drawShip(3, (1 - timer[phase] / 100) * distance * direction * -ship.base + timer[phase + 1] / 100 * distance * direction * (20 + (largebase - ship.base) / 2), start * ship.base / 4 - timer[phase] / 100 * start * ship.base / 2, (1 - 0.7 * ((phase == 0) ? (timer[3] / 100) : 0)) * (0.1 * timer[phase] / 100 + 0.9 * timer[phase + 1] / 100) * (1 - (1 - remnant) * phasemod));
	for (var j = 1; j < ctx.length; j++) {
		ctx[j].restore();
	};
	if ((!sensors && phase == 0 && timer[1] >= 100) || (sensors && timer[phase + 1] >= 100 && ((phase == 4 && !bbPTL) || phase == 8))) {
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].save();
			oRoll(j, distance, direction, start);
		};
		for (var j = dial.length; j > 0; j--) {
			animate(dial[j-1], 2);
		};
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].restore();
		};
	};
	if (sensors && phase == 0 && timer[1] >= 100) {
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].save();
			oRoll(j, distance, direction, start);
		};
		animateBarrelRolls("purple", 4);
		animateBoosts("purple", 6);
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].restore();
		};
	};
	if (bbPTL && phase == 4 && timer[5] >= 100) {
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].save();
			oRoll(j, distance, direction, start);
		};
		animateBank(["bank", "red", 1, -1], 8);
		animateStraight(["straight", "red", 1], 8);
		animateBank(["bank", "red", 1, 1], 8);
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].restore();
		};
	};
};

function animateKoiogran (flightplan, phase) {
	var distance = flightplan[2];
	var cloaking = (decloak.length > 0) ? true : false;
	var bbPTL = (document.getElementById("button_bbPTL").style.opacity > 0) ? false : true;
	var sensors = (document.getElementById("button_sensors").style.opacity > 0) ? false : true;
	for (var j = 1; j < ctx.length; j++) {
		ctx[j].save();
	};
	ctx[1].globalAlpha = (1 - 0.5 * ((phase == 0) ? (timer[3] / 100) : 0)) * 0.5 * timer[phase + 1] / 100;
	ctx[1].beginPath();
	ctx[1].moveTo(0, 0);
	ctx[1].lineTo(0, timer[phase + 1] / 100 * distance * -smallbase);
	ctx[1].strokeStyle = flightplan[1];
	ctx[1].lineWidth = smallbase / 2;
	ctx[1].stroke();
	switch (phase) {
		case 2:
			var phasemod = (sensors) ? 0 : (Math.max(timer[5], timer[7]) / 100);
			break;
		default:
			var phasemod = 0;
			break;
	};
	for (var j = 1; j < ctx.length; j++) {
		ctx[j].translate(0, timer[phase] / 100 * -ship.base + timer[phase + 1] / 100 * distance * -smallbase + ship.base / 2);
		ctx[j].rotate(timer[phase + 1] * 0.01 * pi);
};
	drawShip(3, 0, -ship.base/2, (1 - 0.7 * ((phase == 0) ? (timer[3] / 100) : 0)) * (0.1 * timer[phase] / 100 + 0.9 * timer[phase + 1] / 100) * (1 - (1 - remnant) * phasemod));
	for (var j = 1; j < ctx.length; j++) {
		ctx[j].restore();
	};
	if (!sensors && phase == 2 && timer[3] >= 100) {
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].save();
			oStraight(j, distance);
			oRotate(j, 1);
		};
		animateBarrelRolls("purple", 4);
		animateBoosts("purple", 6);
		animateSlams(distance, 10);
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].restore();
		};
	};
};

function animateSegnors (flightplan, phase) {
	var distance = flightplan[2];
	var direction = flightplan[3];
	var radius = rBank[distance];
	var cloaking = (decloak.length > 0) ? true : false;
	var bbPTL = (document.getElementById("button_bbPTL").style.opacity > 0) ? false : true;
	var sensors = (document.getElementById("button_sensors").style.opacity > 0) ? false : true;
	for (var j = 1; j < ctx.length; j++) {
		ctx[j].save();
		ctx[j].translate(direction * radius, 0);
		ctx[j].rotate(timer[phase + 1] * direction * 0.0025 * pi);
	};
	ctx[1].globalAlpha = (1 - 0.5 * ((phase == 0) ? (timer[3] / 100) : 0)) * 0.5 * timer[phase + 1] / 100;
	ctx[1].beginPath();
	ctx[1].arc (0, 0, radius, (0.5 + direction * 0.5) * pi, (0.5 + direction * 0.5  + direction * timer[phase + 1] * -0.0025) * pi, (direction == 1) ? true : false);
	ctx[1].strokeStyle = flightplan[1];
	ctx[1].lineWidth = smallbase / 2;
	ctx[1].stroke();
	switch (phase) {
		case 2:
			var phasemod = (sensors) ? 0 : (Math.max(timer[5], timer[7]) / 100);
			break;
		default:
			var phasemod = 0;
			break;
	};
	for (var j = 1; j < ctx.length; j++) {
		ctx[j].translate(-direction * radius, -ship.base / 2);
		ctx[j].rotate(timer[phase + 1] * direction * 0.01 * pi);
	};
	drawShip(3, 0, timer[phase] / 100 * -ship.base + ship.base / 2, (1 - 0.7 * ((phase == 0) ? (timer[3] / 100) : 0)) * (0.1 * timer[phase] / 100 + 0.9 * timer[phase + 1] / 100) * (1 - (1 - remnant) * phasemod));
	for (var j = 1; j < ctx.length; j++) {
		ctx[j].restore();
	};
	if (!sensors && phase == 2 && timer[3] >= 100) {
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].save();
			oBank(j, distance, direction);
			oRotate(j, 1);
		};
		animateBarrelRolls("purple", 4);
		animateBoosts("purple", 6);
		animateSlams(distance, 10);
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].restore();
		};
	};
};

function animateStraight (flightplan, phase) {
	var distance = flightplan[2];
	var cloaking = (decloak.length > 0) ? true : false;
	var bbPTL = (document.getElementById("button_bbPTL").style.opacity > 0) ? false : true;
	var sensors = (document.getElementById("button_sensors").style.opacity > 0) ? false : true;
	for (var j = 1; j < ctx.length; j++) {
		ctx[j].save();
	};
	ctx[1].globalAlpha = (1 - 0.5 * ((phase == 0) ? (timer[3] / 100) : 0)) * 0.5 * timer[phase + 1] / 100;
	ctx[1].beginPath();
	ctx[1].moveTo(0, 0);
	ctx[1].lineTo(0, timer[phase + 1] / 100 * distance * -smallbase);
	ctx[1].strokeStyle = flightplan[1];
	ctx[1].lineWidth = smallbase / 2;
	ctx[1].stroke();
	switch (phase) {
		case 2:
			var phasemod = (sensors) ? 0 : (Math.max(timer[5], timer[7]) / 100);
			break;
		case 6:
			var phasemod = (sensors && !bbPTL) ? (timer[3] / 100) : (timer[9] / 100);
			break;
		case 8:
			var phasemod = (sensors) ? (timer[3] / 100) : 0;
			break;
		default:
			var phasemod = 0;
			break;
	};
	drawShip(3, 0, timer[phase] / 100 * -ship.base + timer[phase + 1] / 100 * distance * -smallbase, (1 - 0.7 * ((phase == 0) ? (timer[3] / 100) : 0)) * (0.1 * timer[phase] / 100 + 0.9 * timer[phase + 1] / 100) * (1 - (1 - remnant) * phasemod));
	for (var j = 1; j < ctx.length; j++) {
		ctx[j].restore();
	};
	if ((!sensors && phase == 0 && timer[1] >= 100) || (sensors && timer[phase + 1] >= 100 && ((phase == 6 && !bbPTL) || phase == 8))) {
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].save();
			oStraight(j, distance);
		};
		for (var j = dial.length; j > 0; j--) {
			animate(dial[j-1], 2);
		};
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].restore();
		};
	};
	if ((sensors && phase == 0 && timer[1] >= 100) || (!sensors && phase == 2 && timer[3] >= 100)) {
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].save();
			oStraight(j, distance);
		};
		animateBarrelRolls("purple", 4);
		animateBoosts("purple", 6);
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].restore();
		};
	};
	if (bbPTL && phase == 6 && timer[7] >= 100) {
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].save();
			oStraight(j, distance);
		};
		animateRoll(["roll", "red", 1, -1, 1], 8);
		animateRoll(["roll", "red", 1, -1, -1], 8);
		animateRoll(["roll", "red", 1, 1, 1], 8);
		animateRoll(["roll", "red", 1, 1, -1], 8);
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].restore();
		};
	};
	if (!sensors && phase == 2 && timer[3] >= 100) {
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].save();
			oStraight(j, distance);
		};
		animateSlams(distance, 10);
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].restore();
		};
	};
};

function animateTallon (flightplan, phase) {
	var distance = flightplan[2];
	var direction = flightplan[3];
	var radius = rTurn[distance];
	var cloaking = (decloak.length > 0) ? true : false;
	var bbPTL = (document.getElementById("button_bbPTL").style.opacity > 0) ? false : true;
	var sensors = (document.getElementById("button_sensors").style.opacity > 0) ? false : true;
	for (var j = 1; j < ctx.length; j++) {
		ctx[j].save();
		ctx[j].translate(direction * radius, 0);
		ctx[j].rotate(timer[phase + 1] * direction * 0.005 * pi);
	};
	ctx[1].globalAlpha = (1 - 0.5 * ((phase == 0) ? (timer[3] / 100) : 0)) * 0.5 * timer[phase + 1] / 100;
	ctx[1].beginPath();
	ctx[1].arc (0, 0, radius, (0.5 + direction * 0.5) * pi, (0.5 + direction * 0.5  + direction * timer[phase + 1] * -0.005) * pi, (direction == 1) ? true : false);
	ctx[1].strokeStyle = flightplan[1];
	ctx[1].lineWidth = smallbase / 2;
	ctx[1].stroke();
	switch (phase) {
		case 2:
			var phasemod = (sensors) ? 0 : (Math.max(timer[5], timer[7]) / 100);
			break;
		default:
			var phasemod = 0;
			break;
	};
	for (var j = 1; j < ctx.length; j++) {
		ctx[j].translate(-direction * radius, -ship.base / 2);
		ctx[j].rotate(timer[phase + 1] * direction * 0.005 * pi);
	};
	drawShip(3, 0, timer[phase] / 100 * -ship.base + ship.base / 2 + 0.25 * ship.base * (Math.max(timer[3] - 50, 0) / 50), (1 - 0.7 * ((phase == 0) ? (timer[3] / 100) : 0)) * (0.1 * timer[phase] / 100 + 0.9 * timer[phase + 1] / 100) * (1 - (1 - remnant) * phasemod));
	drawShip(3, 0, timer[phase] / 100 * -ship.base + ship.base / 2 - 0.25 * ship.base * (Math.max(timer[3] - 50, 0) / 50), (1 - 0.7 * ((phase == 0) ? (timer[3] / 100) : 0)) * (0.1 * timer[phase] / 100 + 0.9 * timer[phase + 1] / 100) * (1 - (1 - remnant) * phasemod));
	for (var j = 1; j < ctx.length; j++) {
		ctx[j].restore();
	};
	if (!sensors && phase == 2 && timer[3] >= 100) {
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].save();
			oTurn(j, distance, direction);
			oRotate(j, direction * 0.5);
			ctx[j].translate(0, + ship.base / 4);
		};
		animateBarrelRolls("purple", 4);
		animateBoosts("purple", 6);
		animateSlams(distance, 10);
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].restore();
			ctx[j].save();
			oTurn(j, distance, direction);
			oRotate(j, direction * 0.5);
			ctx[j].translate(0, - ship.base / 4);
		};
		animateBarrelRolls("purple", 4);
		animateBoosts("purple", 6);
		animateSlams(distance, 10);
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].restore();
		};
	};
};

function animateTurn (flightplan, phase) {
	var distance = flightplan[2];
	var direction = flightplan[3];
	var radius = rTurn[distance];
	var cloaking = (decloak.length > 0) ? true : false;
	var bbPTL = (document.getElementById("button_bbPTL").style.opacity > 0) ? false : true;
	var sensors = (document.getElementById("button_sensors").style.opacity > 0) ? false : true;
	for (var j = 1; j < ctx.length; j++) {
		ctx[j].save();
		ctx[j].translate(direction * radius, 0);
		ctx[j].rotate(timer[phase + 1] * direction * 0.005 * pi);
	};
	ctx[1].globalAlpha = (1 - 0.5 * ((phase == 0) ? (timer[3] / 100) : 0)) * 0.5 * timer[phase + 1] / 100;
	ctx[1].beginPath();
	ctx[1].arc (0, 0, radius, (0.5 + direction * 0.5) * pi, (0.5 + direction * 0.5  + direction * timer[phase + 1] * -0.005) * pi, (direction == 1) ? true : false);
	ctx[1].strokeStyle = flightplan[1];
	ctx[1].lineWidth = smallbase / 2;
	ctx[1].stroke();
	switch (phase) {
		case 2:
			var phasemod = (sensors) ? 0 : (Math.max(timer[5], timer[7]) / 100);
			break;
		default:
			var phasemod = 0;
			break;
	};
	drawShip(3, direction * -radius, timer[phase] / 100 * -ship.base, (1 - 0.7 * ((phase == 0) ? (timer[3] / 100) : 0)) * (0.1 * timer[phase] / 100 + 0.9 * timer[phase + 1] / 100) * (1 - (1 - remnant) * phasemod));
	for (var j = 1; j < ctx.length; j++) {
		ctx[j].restore();
	};
	if (!sensors && phase == 2 && timer[3] >= 100) {
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].save();
			oTurn(j, distance, direction);
		};
		animateBarrelRolls("purple", 4);
		animateBoosts("purple", 6);
		animateSlams(distance, 10);
		for (var j = 1; j < ctx.length; j++) {
			ctx[j].restore();
		};
	};
};
-->
</script>
</head>
<body bgcolor=black>
<table cellpadding=0 cellspacing=0>
<tr>
<td width=862 rowspan=8 style="vertical-align: top;"><a id="permalink" style="position: relative; left: 10px;">link</a></td>
<td style="vertical-align:top" height=106>
<table cellpadding=0 width=158>
<tr>
<td class="option"><img src="images/grid.png" class="overlay" style="z-index: -1">
<a id="grid_level"></a>
<img id="option_grid" src="images/blank.png" title="Tactical Overlay" class="overlay option" style="opacity: 0.5;" onClick="gridfield();"></td>
<td class="option"><img src="images/stars.png" class="overlay">
<img id="option_starfield" src="images/blank.png" title="Starfield" class="overlay option" style="opacity: 0.5;" onClick="starfield();"></td>
<td class="option"><img src="images/loop.png" class="overlay">
<img id="option_loop" src="images/blank.png" title="Loop" class="overlay option" style="opacity: 0.5;" onClick="loop();"></td>
</tr>
<tr>
<td class="option"><img src="images/attackR.png" class="overlay" style="z-index: -1">
<a id="fire_range"></a>
<img id="option_fire" src="images/blank.png" title="Firing Arcs" class="overlay option" onClick="fire();" style="opacity: 0.5;">
</td>
<td class="option"><img src="images/clearbase.png" class="overlay">
<img id="option_transparent" src="images/blank.png" title="Transparent Bases" class="overlay option" onClick="transparent();" style="opacity: 0.5;">
</td>
<td class="option"><img id="option_blarg" src="images/blank.png" title="?" class="overlay option" onClick="wharrgarbl = wharrgarbl * -1; stepOverride = true;" style="opacity: 0;">
</td>
</tr>
</table>
</td>
</tr>
<tr>
<td height=10></td>
</tr>
<tr>
<td style="vertical-align: top;" height=74>
<table cellpadding=0 id="tDecloak">
<tr class="decloakE">
<td width=22></td>
<td></td>
<td class="button move"><img src="images/bankC.png"><img id="decloak0e" src="images/blank.png" class="overlay decloak" onClick="setDecloak('e', 0);"></td>
<td class="button move"><img src="images/bankC.png" class="mirror"><img id="decloak1e" src="images/blank.png" class="overlay decloak" onClick="setDecloak('e', 1);"></td>
</tr>
<tr class="decloakP" hidden>
<td width=22></td>
<td></td>
<td class="button move" colspan=2><img src="images/straightC.png"><img id="decloak0p" src="images/blank.png" class="overlay decloak" style="width: 44px;" onClick="setDecloak('p', 0);"></td>
</tr>
<tr>
<td></td>
<td class="button move decloakE"><img src="images/bankC.png" class="mirrorL"><img id="decloak2e" src="images/blank.png" class="overlay decloak" onClick="setDecloak('e', 2, 3);"></td>
<td class="button move decloakP"><img src="images/straightC.png" class="rotateL"><img id="decloak1p" src="images/blank.png" class="overlay decloak" onClick="setDecloak('p', 1);"></td>
<td class="button move" colspan=2 rowspan=2><img src="images/cloak.png"><img id="decloakA" src="images/blank.png" class="overlay decloak" style="width: 44px; height: 44px;" onClick="setDecloak('all');"></td>
<td class="button move decloakE"><img src="images/bankC.png" class="rotateR"><img id="decloak4e" src="images/blank.png" class="overlay decloak" onClick="setDecloak('e', 4, 5);"></td>
<td class="button move decloakP"><img src="images/straightC.png" class="rotateR"><img id="decloak2p" src="images/blank.png" class="overlay decloak" onClick="setDecloak('p', 2);"></td>
</tr>
<tr>
<td></td>
<td class="button move decloakE"><img src="images/bankC.png" class="rotateL"><img id="decloak6e" src="images/blank.png" class="overlay decloak" onClick="setDecloak('e', 6, 7);"></td>
<td class="button move decloakP"><img src="images/straightC.png" class="rotateL"><img id="decloak3p" src="images/blank.png" class="overlay decloak" onClick="setDecloak('p', 3);"></td>
<td class="button move decloakE"><img src="images/bankC.png" class="mirrorR"><img id="decloak8e" src="images/blank.png" class="overlay decloak" onClick="setDecloak('e', 8, 9);"></td>
<td class="button move decloakP"><img src="images/straightC.png" class="rotateR"><img id="decloak4p" src="images/blank.png" class="overlay decloak" onClick="setDecloak('p', 4);"></td>
</tr>
</table>
</td>
</tr>
<tr>
<td height=10></td>
</tr>
<tr>
<td style="vertical-align:top" height=146>
<table cellpadding=0>
<tr id="mRow5">
<td class="button move">5</td>
<td class="button move" id="mTurn5l"><img id="aTurn5l" src="images/turnW.png"><img id="bTurn5l" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mBank5l"><img id="aBank5l" src="images/bankW.png"><img id="bBank5l" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mStraight5"><img id="aStraight5" src="images/straightW.png"><img id="bStraight5" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mBank5r"><img id="aBank5r" src="images/bankW.png" class="mirror"><img id="bBank5r" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mTurn5r"><img id="aTurn5r" src="images/turnW.png" class="mirror"><img id="bTurn5r" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mKoiogran5"><img id="aKoiogran5" src="images/koiogranR.png"><img id="bKoiogran5" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mSegnors5l"><img id="aSegnors5l" src="images/segnorsR.png"><img id="bSegnors5l" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mSegnors5r"><img id="aSegnors5r" src="images/segnorsR.png" class="mirror"><img id="bSegnors5r" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mTallon5l"><img id="aTallon5l" src="images/tallonR.png"><img id="bTallon5l" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mTallon5r"><img id="aTallon5r" src="images/tallonR.png" class="mirror"><img id="bTallon5r" src="images/blank.png" class="overlay maneuver"></td>
</tr>
<tr>
<td class="button move">4</td>
<td class="button move" id="mTurn4l"><img id="aTurn4l" src="images/turnW.png"><img id="bTurn4l" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mBank4l"><img id="aBank4l" src="images/bankW.png"><img id="bBank4l" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mStraight4"><img id="aStraight4" src="images/straightW.png"><img id="bStraight4" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mBank4r"><img id="aBank4r" src="images/bankW.png" class="mirror"><img id="bBank4r" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mTurn4r"><img id="aTurn4r" src="images/turnW.png" class="mirror"><img id="bTurn4r" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mKoiogran4"><img id="aKoiogran4" src="images/koiogranR.png"><img id="bKoiogran4" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mSegnors4l"><img id="aSegnors4l" src="images/segnorsR.png"><img id="bSegnors4l" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mSegnors4r"><img id="aSegnors4r" src="images/segnorsR.png" class="mirror"><img id="bSegnors4r" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mTallon4l"><img id="aTallon4l" src="images/tallonR.png"><img id="bTallon4l" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mTallon4r"><img id="aTallon4r" src="images/tallonR.png" class="mirror"><img id="bTallon4r" src="images/blank.png" class="overlay maneuver"></td>
</tr>
<tr>
<td class="button move">3</td>
<td class="button move" id="mTurn3l"><img id="aTurn3l" src="images/turnW.png"><img id="bTurn3l" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mBank3l"><img id="aBank3l" src="images/bankW.png"><img id="bBank3l" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mStraight3"><img id="aStraight3" src="images/straightG.png"><img id="bStraight3" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mBank3r"><img id="aBank3r" src="images/bankW.png" class="mirror"><img id="bBank3r" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mTurn3r"><img id="aTurn3r" src="images/turnW.png" class="mirror"><img id="bTurn3r" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mKoiogran3"><img id="aKoiogran3" src="images/koiogranR.png"><img id="bKoiogran3" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mSegnors3l"><img id="aSegnors3l" src="images/segnorsR.png"><img id="bSegnors3l" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mSegnors3r"><img id="aSegnors3r" src="images/segnorsR.png" class="mirror"><img id="bSegnors3r" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mTallon3l"><img id="aTallon3l" src="images/tallonR.png"><img id="bTallon3l" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mTallon3r"><img id="aTallon3r" src="images/tallonR.png" class="mirror"><img id="bTallon3r" src="images/blank.png" class="overlay maneuver"></td>
</tr>
<tr>
<td class="button move">2</td>
<td class="button move" id="mTurn2l"><img id="aTurn2l" src="images/turnW.png"><img id="bTurn2l" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mBank2l"><img id="aBank2l" src="images/bankG.png"><img id="bBank2l" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mStraight2"><img id="aStraight2" src="images/straightG.png"><img id="bStraight2" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mBank2r"><img id="aBank2r" src="images/bankG.png" class="mirror"><img id="bBank2r" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mTurn2r"><img id="aTurn2r" src="images/turnW.png" class="mirror"><img id="bTurn2r" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mKoiogran2"><img id="aKoiogran2" src="images/koiogranR.png"><img id="bKoiogran2" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mSegnors2l"><img id="aSegnors2l" src="images/segnorsR.png"><img id="bSegnors2l" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mSegnors2r"><img id="aSegnors2r" src="images/segnorsR.png" class="mirror"><img id="bSegnors2r" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mTallon2l"><img id="aTallon2l" src="images/tallonR.png"><img id="bTallon2l" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mTallon2r"><img id="aTallon2r" src="images/tallonR.png" class="mirror"><img id="bTallon2r" src="images/blank.png" class="overlay maneuver"></td>
</tr>
<tr>
<td class="button move">1</td>
<td class="button move" id="mTurn1l"><img id="aTurn1l" src="images/turnW.png"><img id="bTurn1l" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mBank1l"><img id="aBank1l" src="images/bankG.png"><img id="bBank1l" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mStraight1"><img id="aStraight1" src="images/straightG.png"><img id="bStraight1" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mBank1r"><img id="aBank1r" src="images/bankG.png" class="mirror"><img id="bBank1r" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mTurn1r"><img id="aTurn1r" src="images/turnW.png" class="mirror"><img id="bTurn1r" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mKoiogran1"><img id="aKoiogran1" src="images/koiogranR.png"><img id="bKoiogran1" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mSegnors1l"><img id="aSegnors1l" src="images/segnorsR.png"><img id="bSegnors1l" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mSegnors1r"><img id="aSegnors1r" src="images/segnorsR.png" class="mirror"><img id="bSegnors1r" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mTallon1l"><img id="aTallon1l" src="images/tallonR.png"><img id="bTallon1l" src="images/blank.png" class="overlay maneuver"></td>
<td class="button move" id="mTallon1r"><img id="aTallon1r" src="images/tallonR.png" class="mirror"><img id="bTallon1r" src="images/blank.png" class="overlay maneuver"></td>
</tr>
<tr>
<td class="button move" style="border: none;" colspan=2></td>
<td class="button" colspan=3>ALL<img src="images/blank.png" id="all" class="overlay maneuver" style="width: 68px;" onClick="setDial('all');"></td>
</tr>
</table>
</td>
</tr>
<tr><td height=1></td></tr>
<tr>
<td style="vertical-align:top" height=104>
<table cellpadding=0>
<tr>
<td class="button actions">
<img src="images/rollG.png">
<a id="lock_roll" class="lock"></a>
<img id="button_barrel" src="images/blank.png" title="Barrel Roll" class="overlay" width=44 height=30 onClick="barrel_roll();" onMouseOver="switchFilter('roll');" style="opacity: 0.5">
</td>
<td class="button actions">
<img src="images/boostG.png">
<a id="lock_boost" class="lock"></a>
<img id="button_boost" src="images/blank.png" title="Boost" class="overlay" width=44 height=30 onClick="boost();" onMouseOver="switchFilter('boost');" style="opacity: 0.5">
</td>
<td class="button actions">
<img src="images/slamG.png">
<a id="lock_boost" class="lock"></a>
<img id="button_slam" src="images/blank.png" title="SLAM" class="overlay" width=44 height=30 onClick="slam();" onMouseOver="switchFilter('none');" style="opacity: 1">
</td>
<tr>
<td class="button" colspan=2 rowspan=2>
<table cellpadding=0 align=center>
<tr id="boostFilters" hidden>
<td><img src="images/bankW.png"><img id="button_boostFilter0" src="images/blank.png" class="overlay" width=17 height=19 onClick="setFilter('boost', 0);" style="opacity: 0"></td>
<td><img src="images/straightW.png"><img id="button_boostFilter1" src="images/blank.png" class="overlay" width=17 height=19 onClick="setFilter('boost', 1);" style="opacity: 0"></td>
<td><img src="images/bankW.png" class="mirror"><img id="button_boostFilter2" src="images/blank.png" class="overlay" width=17 height=19 onClick="setFilter('boost', 2);" style="opacity: 0"></td>
</tr>
<tr id="rollFiltersA" hidden>
<td><img src="images/straightW.png" style="transform: rotate(-90deg); -webkit-transform: rotate(-90deg);"><img id="button_rollFilter0" src="images/blank.png" class="overlay" width=19 height=19 onClick="setFilter('roll', 0);" style="opacity: 0"></td>
<td rowspan=2 width=17></td>
<td><img src="images/straightW.png" style="transform: rotate(90deg); -webkit-transform: rotate(90deg);"><img id="button_rollFilter1" src="images/blank.png" class="overlay" width=19 height=19 onClick="setFilter('roll', 1);" style="opacity: 0"></td>
</tr>
<tr id="rollFiltersB" hidden>
<td><img src="images/straightW.png" style="transform: rotate(-90deg); -webkit-transform: rotate(-90deg);"><img id="button_rollFilter2" src="images/blank.png" class="overlay" width=19 height=19 onClick="setFilter('roll', 2);" style="opacity: 0"></td>
<td><img src="images/straightW.png" style="transform: rotate(90deg); -webkit-transform: rotate(90deg);"><img id="button_rollFilter3" src="images/blank.png" class="overlay" width=19 height=19 onClick="setFilter('roll', 3);" style="opacity: 0"></td>
</tr>
</table>
</td>
<td class="button actions">
<img src="images/bbPTL.png">
<a id="lock_bbPTL" class="lock"></a>
<img id="button_bbPTL" src="images/blank.png" title="Push the Limit: Boost + Barrel Roll" class="overlay" width=44 height=30 onClick="bbPTL();" onMouseOver="switchFilter('none');" style="opacity: 1">
</td>
</tr>
<tr>
<td class="button actions"><img src="images/systemW.png">
<a id="lock_sensors" class="lock"></a>
<img id="button_sensors" src="images/blank.png" title="Advanced Sensors" class="overlay" width=44 height=30 onClick="advSensors();" onMouseOver="switchFilter('none');" style="opacity: 1">
</td>
</tr>
</table>
</td>
</tr>
<tr><td height=1></td></tr>
<tr>
<td colspan=2>
<table cellpadding=0 height=126>
<tr>
<td class="select option"><img id="select_empire" src="images/empire.png" title="Galactic Empire" class="select faction" style="opacity: 1" onClick="select ('empire');"><img id="select_alliance" src="images/alliance.png" title="Rebel Alliance" class="select faction" onClick="select('alliance');"><img id="select_scum" src="images/scum.png" title="Scum and Villainy" class="select faction" onClick="select('scum');"></td>
<td width=5></td>
<td id="select_decimator" class="option select empire model"><img src="images/decimator.png" title="VT-49 Decimator" onClick="select(decimator);" style="position: relative; left: 0px; bottom: -12px;"></td>
<td id="select_lambda" class="option select empire model"><img src="images/lambda.png" title="Lambda-Class Shuttle" onClick="select(lambda);" style="position: relative; left: 0px; bottom: 5px;"></td>
<td id="select_firespray" class="option select empire model"><img src="images/firespray.png" title="Firespray-31" onClick="select(firespray);" style="position: relative; left: 0px; bottom: 5px;"></td>
<td id="select_tieadvanced" class="option select empire model"><img src="images/tieadvanced.png" title="TIE Advanced" onClick="select(tieadvanced);" style="position: relative; left: 0px; bottom: -2px;"></td>
<td id="select_junoeclipse" class="option select empire pilot"><a class="pilot" onClick="select(tieadvanced, junoeclipse);" style="position: relative; left: 0px; bottom: 22px;">&middot;Juno Eclipse</a></td>
<td id="select_tieadvprototype" class="option select empire model"><img src="images/tieadvprototype.png" title="TIE Adv. Prototype" onClick="select(tieadvprototype);" style="position: relative; left: 0px; bottom: 5px;"></td>
<td id="select_tiebomber" class="option select empire model"><img src="images/tiebomber.png" title="TIE Bomber" onClick="select(tiebomber);" style="position: relative; left: 0px; bottom: -1px;"></td>
<td id="select_tiedefender" class="option select empire model"><img src="images/tiedefender.png" title="TIE Defender" onClick="select(tiedefender);" style="position: relative; left: 0px; bottom: 4px;"></td>
<td id="select_countessryad" class="option select empire pilot"><a class="pilot" onClick="select(tiedefender, countessryad);" style="position: relative; left: 0px; bottom: 23px;">&middot;Countess Ryad</a></td>
<td id="select_tiefighter" class="option select empire model"><img src="images/tiefighter.png" title="TIE Fighter" onClick="select(tiefighter);" style="position: relative; left: 0px; bottom: 5px;"></td>
<td id="select_tieinterceptor" class="option select empire model"><img src="images/tieinterceptor.png" title="TIE Interceptor" onClick="select(tieinterceptor);" style="position: relative; left: 0px; bottom: 5px;"></td>
<td id="select_tiephantom" class="option select empire model"><img src="images/tiephantom.png" width=40 title="TIE Phantom" onClick="select(tiephantom);" style="position: relative; left: 0px; bottom: 5px;"></td>
<td id="select_echo" class="option select empire pilot"><a class="pilot" onClick="select(tiephantom, echo);" style="position: relative; left: 0px; bottom: 34px;">&middot;Echo</a></td>
<td id="select_tiepunisher" class="option select empire model"><img src="images/tiepunisher.png" title="TIE Punisher" onClick="select(tiepunisher);" style="position: relative; left: 0px; bottom: -3px;"></td>
<td id="select_tiefofighter" class="option select empire model"><img src="images/tiefofighter.png" title="TIE/fo Fighter" onClick="select(tiefofighter);" style="position: relative; left: 0px; bottom: 5px;"></td>
<td id="select_tiesffighter" class="option select empire model"><img src="images/tiesffighter.png" title="TIE/sf fighter" onClick="select(tiesffighter);" style="position: relative; left: 0px; bottom: 5px;"></td>
<td id="select_vcx100" class="option select alliance model"><img src="images/vcx100-f.png" title="VCX-100" onClick="select(vcx100);" style="position: relative; left: 0px; bottom: 5px;"><img src="images/vcx100-r.png" title="VCX-100" onClick="select(vcx100);" style="position: absolute; left: 0px; bottom: -42px;"></td>
<td id="select_yt1300" class="option select alliance model"><img src="images/yt1300.png" title="YT-1300" onClick="select(yt1300);" style="position: relative; left: 0px; bottom: 0px;"></td>
<td id="select_yt2400" class="option select alliance model"><img src="images/yt2400.png" title="YT-2400" onClick="select(yt2400);" style="position: relative; left: 0px; bottom: 5px;"></td>
<td id="select_awing" class="option select alliance model"><img src="images/awing.png" title="A-Wing" onClick="select(awing);" style="position: relative; left: 0px; bottom: 5px;"></td>
<td id="select_bwing" class="option select alliance model"><img src="images/bwing.png" title="B-Wing" onClick="select(bwing);" style="position: relative; left: 0px; bottom: 5px;"></td>
<td id="select_ewing" class="option select alliance model"><img src="images/ewing.png" title="E-Wing" onClick="select(ewing);" style="position: relative; left: 0px; bottom: 5px;"></td>
<td id="select_kwing" class="option select alliance model"><img src="images/kwing.png" title="K-Wing" onClick="select(kwing);" style="position: relative; left: 0px; bottom: -5px;"></td>
<td id="select_xwing" class="option select alliance model"><img src="images/xwing.png" title="X-Wing" onClick="select(xwing);" style="position: relative; left: 0px; bottom: 5px;"></td>
<td id="select_ywing" class="option select alliance model"><img src="images/ywing.png" title="Y-Wing" onClick="select(ywing);" style="position: relative; left: 0px; bottom: -4px;"></td>
<td id="select_z95" class="option select alliance model"><img src="images/z95.png" title="Z-95 Headhunter" onClick="select(z95);" style="position: relative; left: 0px; bottom: 5px;"></td>
<td id="select_attackshuttle" class="option select alliance model"><img src="images/attackshuttle.png" title="Attack Shuttle" onClick="select(attackshuttle);" style="position: relative; left: 0px; bottom: 5px;"></td>
<td id="select_hwk" class="option select alliance model"><img src="images/hwk.png" title="HWK-290" onClick="select(hwk);" style="position: relative; left: 0px; bottom: 2px;"></td>
<td id="select_t70xwing" class="option select alliance model"><img src="images/t70xwing.png" title="T-70 X-Wing" onClick="select(t70xwing);" style="position: relative; left: 0px; bottom: 5px;"></td>
<td id="select_yv666" class="option select scum model"><img src="images/yv666-f.png" title="YV-666" onClick="select(yv666);" style="position: relative; left: 0px; bottom: 5px;"><img src="images/yv666-r.png" title="YV-666" onClick="select(yv666);" style="position: absolute; left: 0px; bottom: -49px;"></td>
<td id="select_aggressor" class="option select scum model"><img src="images/aggressor.png" title="Aggressor" onClick="select(aggressor);" style="position: relative; left: 0px; bottom: 5px;"></td>
<td id="select_Sfirespray" class="option select scum model"><img src="images/firespray.png" title="Firespray-31" onClick="select(Sfirespray);" style="position: relative; left: 0px; bottom: 5px;"></td>
<td id="select_jumpmaster5000" class="option select scum model"><img src="images/jumpmaster5000.png" title="JumpMaster 5000" onClick="select(jumpmaster5000);" style="position: relative; left: 0px; bottom: 5px;"></td>
<td id="select_g1a" class="option select scum model"><img src="images/g1a.png" title="G-1A Starfighter" onClick="select(g1a);" style="position: relative; left: 0px; bottom: -1px;"></td>
<td id="select_Shwk" class="option select scum model"><img src="images/hwk.png" title="HWK-290" onClick="select(Shwk);" style="position: relative; left: 0px; bottom: 2px;"></td>
<td id="select_kihraxz" class="option select scum model"><img src="images/kihraxz.png" title="Kihraxz Fighter" onClick="select(kihraxz);" style="position: relative; left: 0px; bottom: 5px;"></td>
<td id="select_scyk" class="option select scum model"><img src="images/scyk.png" title="M3-A Interceptor" onClick="select(scyk);" style="position: relative; left: 0px; bottom: -6px;"></td>
<td id="select_starviper" class="option select scum model"><img src="images/starviper.png" title="StarViper" onClick="select(starviper);" style="position: relative; left: 0px; bottom: 2px;"></td>
<td id="select_Sywing" class="option select scum model"><img src="images/ywing-s.png" title="Y-Wing" onClick="select(Sywing);" style="position: relative; left: 0px; bottom: -5px;"></td>
<td id="select_Sz95" class="option select scum model"><img src="images/z95-s.png" title="Z-95 Headhunter" onClick="select(Sz95);" style="position: relative; left: 0px; bottom: 5px;"></td>
</tr>
</table>
</td>
</tr>
</table>
<canvas id="layer0" width="800" height="600"></canvas>
<canvas id="gridlayer" width="800" height="600"></canvas>
<canvas id="layer1" width="800" height="600"></canvas>
<canvas id="layer2" width="800" height="600"></canvas>
<canvas id="layer3" width="800" height="600"></canvas>
</body>
</html>